\section{Performance}
\label{sec:performance}

The performance of the $m_{\Pgt\Pgt}$ reconstruction is studied in simulated events.
Samples of SM $\PHiggs \to \Pgt\Pgt$ signal events
are generated with the next-to-leading-order (NLO) program POWHEG v2~\cite{POWHEG1,POWHEG2,POWHEG3}
for a $\PHiggs$ boson of mass $m_{\PHiggs} = 125$~\GeV 
and for the gluon fusion ($\Pg\Pg \to \PHiggs$) and vector boson fusion ($\Pquark\APquark \to \PHiggs$) production processes.
We also study the $m_{\Pgt\Pgt}$ reconstruction in events containing
heavy pseudoscalar Higgs bosons $\PHiggsps$ of mass $m_{\PHiggsps} = 200$, $300$, $500$, $800$, $1200$, $1800$, and $2600$~\GeV,
produced via gluon fusion, and in events containing heavy spin $1$
resonances, of mass $2500$~\GeV, that decay into $\Pgt$ pairs.
We denote the latter by the symbol $\PZ'$. 
The $\PHiggsps \to \Pgt\Pgt$ and $\PZ' \to \Pgt\Pgt$ signal samples are generated with the LO generator PYTHIA 8.2~\cite{pythia8}.
The $\PZ/\Pggx \to \Pgt\Pgt$ background sample is generated with the LO MadGraph program, in the version MadGraph\_aMCatNLO 2.2.2~\cite{MadGraph_aMCatNLO}.
The sample contains $\Pgt$ lepton pairs of true mass $m_{\Pgt\Pgt}^{\true} > 50$~\GeV.
Most of the $\Pgt$ lepton pairs have a mass near the $\PZ$ peak at $m_{\PZ} = 91.2$~GeV and width $\Gamma_{\PZ} = 2.5$~\GeV~\cite{PDG}, 
but the sample also contains events of significantly higher mass.
Drell--Yan events of mass $m_{\Pgt\Pgt}^{\true} < 50$~\GeV are not relevant for this study, 
because they do not pass the selection criteria on $\pT$ and $\eta$ that are applied on analysis level.
All events are generated for proton-proton collisions at $\sqrt{s} = 13$~\TeV centre-of-mass energy.
The samples produced by MadGraph and POWHEG are generated with the NNPDF3.0 set of parton distribution functions,
while the samples produced by PYTHIA use the NNPDF2.3LO set~\cite{NNPDF1,NNPDF2,NNPDF3}.
Parton shower and hadronization processes are modelled using the generator PYTHIA with the tune CUETP8M1~\cite{PYTHIA_CUETP8M1tune_CMS}.
The latter is based on the Monash tune~\cite{PYTHIA_MonashTune}.
The decays of $\Pgt$ leptons, including polarization effects, are modelled by PYTHIA.
The samples are normalized according to cross section for the purpose of comparing different mass reconstruction algorithms in terms of analysis sensitivity.
The cross section of the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background is computed at NNLO accuracy and amounts to $2.01 \times 10^{3}$~pb~\cite{FEWZ}.
The cross sections for the SM $\PHiggs \to \Pgt\Pgt$ signal have been computed as detailed in Ref.~\cite{Dittmaier:2011ti},
with the updates described in Ref.~\cite{Heinemeyer:2013tqa} included.
They amount to $43.9$~pb for the $\Pg\Pg \to \PHiggs$ and to $3.75$~pb for the $\Pquark\APquark \to \PHiggs$ production process.
The $\PHiggsps \to \Pgt\Pgt$ and $\PZ' \to \Pgt\Pgt$ samples 
are scaled to a product of cross section times branching fraction, for the decay into $\Pgt$ lepton pairs, of $1$~pb.

The experimental resolutions on the $\pT$ of $\tauh$ and on the $\pX^{\rec}$ and $\pY^{\rec}$ of the hadronic recoil 
are simulated by sampling from the TF described in
Sections~\ref{sec:mem_TF_tauToHadDecays}
and~\ref{sec:mem_TF_hadRecoil}.
The $\eta$, $\phi$, and $m_{\vis}$ of $\tauh$,
as well as the $\pT$, $\eta$, and $\phi$ of electrons and muons are assumed to be reconstructed perfectly.

Distributions in $m_{\Pgt\Pgt}$ are computed separately for events in which 
both $\Pgt$ leptons decay hadronically ($\tauh\tauh$), 
events in which one $\Pgt$ lepton decays hadronically and the other into a muon ($\Pgm\tauh$),
and events in which one $\Pgt$ lepton decays into a muon and the other into an electron ($\Pe\Pgm$).
The visible $\Pgt$ decay products are required to pass selection criteria on $\pT$ and $\eta$,
which are motivated by the SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$~\cite{HIG-13-004}.
Events in the $\tauh\tauh$ decay channel are required to contain
two $\tauh$ of $\pT > 45$~\GeV and $\vert\eta\vert < 2.1$.
Events in the $\Pgm\tauh$ channel
are required to contain a muon of $\pT > 20$~\GeV and $\vert\eta\vert < 2.1$ and a $\tauh$ of $\pT > 30$~\GeV and $\vert\eta\vert < 2.3$.
Events selected in the $\Pe\Pgm$ channel are required to contain a muon with $\vert\eta\vert < 2.1$ and an electron with $\vert\eta\vert < 2.4$.
The lepton of higher $\pT$ (either the electron or the muon) is required to satisfy the condition $\pT > 20$~\GeV,
while the lepton of lower $\pT$ is required to satisfy $\pT > 10$~\GeV.
Similar selection criteria on $\pT$ and $\eta$ of the visible $\Pgt$ decay products were applied in the $\PHiggs \to \Pgt\Pgt$
analyses performed by the ATLAS
collaboration during LHC Run $1$~\cite{ATLAS_HiggsTauTau_SM,ATLAS_HiggsTauTau_MSSM}.

The $m_{\Pgt\Pgt}$ reconstruction in SM $\PHiggs \to \Pgt\Pgt$ signal events is studied in event categories motivated by the
SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$~\cite{HIG-13-004}:
\begin{itemize}
\item $0$-jet: 
  $\Pg\Pg \to \PHiggs$ signal events 
  containing no jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$.
\item $1$-jet non--boosted:
  $\Pg\Pg \to \PHiggs$ signal events 
  containing exactly one jet of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$,
  and a $\PHiggs$ boson of $\pT < 100$~\GeV.
\item $1$-jet boosted:
  $\Pg\Pg \to \PHiggs$ signal events 
  containing exactly one jet of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$,
  and a $\PHiggs$ boson of $\pT > 100$~\GeV.
\item $2$-jet VBF:
  $\Pquark\APquark \to \PHiggs$ signal events
  containing two or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$,
  with at least one pair of jets satisfying $m_{jj} > 500$~\GeV and $\Delta\eta_{jj} > 3.5$.
\end{itemize}
The event categorization is based on generator level quantities.
The $m_{\Pgt\Pgt}$ distributions reconstructed by the SVfitMEM and cSVfit algorithms in these event categories 
in the $\tauh\tauh$, $\Pgm\tauh$, and $\Pe\Pgm$ decay channels are shown in Figs.~\ref{fig:massDistributions_sm_tautau} to~\ref{fig:massDistributions_sm_emu}.
They are compared to the distributions in $m_{\Pgt\Pgt}$  reconstructed by the previous version of the
SVfit algorithm, described in Ref.~\cite{SVfit}, to which we refer to as the SVfit ``standalone'' (SVfitSA) algorithm,
and by the ``collinear-approximation'' (CA) method~\cite{massRecoCollinearApprox}.
The distributions reconstructed by the SVfitMEM and cSVfit algorithms are compared
for the case that the artificial regularization term described in Section~\ref{sec:mem_logM} is used as well as for the case that it is not used.
In case of the SVfitMEM (cSVfit) algorithm we use $\kappa = 3$ ($\kappa = X$) for the $\Pgm\tauh$ and $\tauh\tauh$ channels and $\kappa = 2$ ($\kappa = X$) for the $\Pe\Pgm$ channel.
The values of $\kappa$ have been chosen such that the optimal resolution on $m_{\Pgt\Pgt}$, 
quantified in terms of the ratio of the standard deviation $\sigma$ to the median $\textrm{M}$ of the distribution,
is achieved in each channel.
We expect the optimal choice of $\kappa$ for data analyses
to depend on the rates of signal and background processes as well as on the experimental resolution,
and we recommend to perform a reoptimization of $\kappa$ in practical applications of our algorithm.
Numerical values for the resolution in $m_{\Pgt\Pgt}$ achieved by the different algorithms are given in Tables~\ref{tab:resolutions_sm_tautau} to~\ref{tab:resolutions_sm_emu}.
The mass of the visible $\Pgt$ decay products, $m_{\vis}$, is included in the Tables for comparison.
The choice of quantifying the resolution in terms of the ratio $\sigma/\textrm{M}$ is motivated 
by the fact that the distributions in $m_{\Pgt\Pgt}$, respectively in $m_{\vis}$, may be shifted with respect to $m_{\Pgt\Pgt}^{\true}$.
While the distributions in $m_{\Pgt\Pgt}$ reconstructed by the different versions of the SVfit algorithm,
as well as by the CA method, peak close to $m_{\Pgt\Pgt}^{\true}$,
the distributions in $m_{\vis}$ exhibit significant shifts towards lower mass.
All algorithms can be trivially calibrated such that the median of each mass distribution coincides with the true mass of the $\Pgt$ lepton pair,
by scaling the output of the algorithm by a suitably chosen constant.
The advantage of quantifying the resolution in terms of the ratio $\sigma/\textrm{M}$ is that the ratio
is invariant under such scaling.

%----------------------------------------------------------------------------------------------------
%
% mTauTau distributions in SM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(180,216)(0,0)
%\put(-2.5, 170.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_hadhad_0jet_log.pdf}}}
%\put(57.5, 170.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_hadhad_0jet_log.pdf}}}
%\put(137.5, 176.0){\mbox{\includegraphics*[width=42mm]
%  {plots/makeSVfitMEM_PerformancePlots_legend_hadhad.pdf}}}
%\put(-2.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_hadhad_1jetLo_log.pdf}}}
%\put(57.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_hadhad_1jetLo_log.pdf}}}
%\put(-2.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_hadhad_1jetHi_log.pdf}}}
%\put(57.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_hadhad_1jetHi_log.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_hadhad_vbf_log.pdf}}}
%\put(57.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_hadhad_vbf_log.pdf}}}
\put(25.0, 168.0){\small (a)}
\put(85.0, 168.0){\small (b)}
\put(25.0, 112.0){\small (c)}
\put(85.0, 112.0){\small (d)}
\put(25.0,  56.0){\small (e)}
\put(85.0,  56.0){\small (f)}
\put(25.0,   0.0){\small (g)}
\put(85.0,   0.0){\small (h)}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by different algorithms in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background ground events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non--boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\tauh\tauh$ decay channel.
}
\label{fig:massDistributions_sm_tautau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(180,216)(0,0)
%\put(-2.5, 170.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_muhad_0jet_log.pdf}}}
%\put(57.5, 170.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_muhad_0jet_log.pdf}}}
%\put(137.5, 176.0){\mbox{\includegraphics*[width=42mm]
%  {plots/makeSVfitMEM_PerformancePlots_legend_muhad.pdf}}}
%\put(-2.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_muhad_1jetLo_log.pdf}}}
%\put(57.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_muhad_1jetLo_log.pdf}}}
%\put(-2.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_muhad_1jetHi_log.pdf}}}
%\put(57.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_muhad_1jetHi_log.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_muhad_vbf_log.pdf}}}
%\put(57.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_muhad_vbf_log.pdf}}}
\put(25.0, 168.0){\small (a)}
\put(85.0, 168.0){\small (b)}
\put(25.0, 112.0){\small (c)}
\put(85.0, 112.0){\small (d)}
\put(25.0,  56.0){\small (e)}
\put(85.0,  56.0){\small (f)}
\put(25.0,   0.0){\small (g)}
\put(85.0,   0.0){\small (h)}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by different algorithms in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background ground events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non--boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\Pgm\tauh$ decay channel.
}
\label{fig:massDistributions_sm_mutau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(180,216)(0,0)
%\put(-2.5, 170.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_emu_0jet_log.pdf}}}
%\put(57.5, 170.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_emu_0jet_log.pdf}}}
%\put(137.5, 176.0){\mbox{\includegraphics*[width=42mm]
%  {plots/makeSVfitMEM_PerformancePlots_legend_emu.pdf}}}
%\put(-2.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_emu_1jetLo_log.pdf}}}
%\put(57.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_emu_1jetLo_log.pdf}}}
%\put(-2.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_emu_1jetHi_log.pdf}}}
%\put(57.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_emu_1jetHi_log.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_DYJets_emu_vbf_log.pdf}}}
%\put(57.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu125_emu_vbf_log.pdf}}}
\put(25.0, 168.0){\small (a)}
\put(85.0, 168.0){\small (b)}
\put(25.0, 112.0){\small (c)}
\put(85.0, 112.0){\small (d)}
\put(25.0,  56.0){\small (e)}
\put(85.0,  56.0){\small (f)}
\put(25.0,   0.0){\small (g)}
\put(85.0,   0.0){\small (h)}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by different algorithms in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background ground events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non--boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\Pe\Pgm$ decay channel.
}
\label{fig:massDistributions_sm_emu}
\end{figure}
%----------------------------------------------------------------------------------------------------

%----------------------------------------------------------------------------------------------------
%
% mass resolutions in SM Higgs->tautau signal and Z/gamma*->tautau background events,
% in event categories motivated by Run 1 SM Higgs->tautau analysis
%
\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=X$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed different versions of SVfit algorithm
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background (B) and SM $\PHiggs \to \Pgt\Pgt$ signal (S) events 
  selected in different event categories of the $\tauh\tauh$ decay channel.
  For the signal also the ratio $S/\sqrt{B}$,
  computed within a mass window that contains $68\%$ of signal events, is given.
}
\label{tab:resolutions_sm_tautau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=X$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed different versions of SVfit algorithm
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background (B) and SM $\PHiggs \to \Pgt\Pgt$ signal (S) events 
  selected in different event categories of the $\Pgm\tauh$ decay channel.
  For the signal also the ratio $S/\sqrt{B}$,
  computed within a mass window that contains $68\%$ of signal events, is given.
}
\label{tab:resolutions_sm_mutau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=X$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=2$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $-$ &  $XXX.X$ & $X.XXX$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet non--boosted &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad$ $1$-jet boosted      &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $XXX.X$ & $X.XXX$ & $X.XXX$ &  $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed different versions of SVfit algorithm
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background (B) and SM $\PHiggs \to \Pgt\Pgt$ signal (S) events 
  selected in different event categories of the $\Pe\Pgm$ decay channel.
  For the signal also the ratio $S/\sqrt{B}$,
  computed within a mass window that contains $68\%$ of signal events, is given.
}
\label{tab:resolutions_sm_emu}
\end{table}
%----------------------------------------------------------------------------------------------------

The distributions in $m_{\Pgt\Pgt}$ reconstructed by the cSVfit and SVfitMEM algorithms with non--zero $\kappa$
and by the SVfitSA algorithm are very similar.
The SVfitSA algorithm performs well without adding an artificial regularization term of the type described in Section~\ref{sec:mem_logM} to its likelihood function.
This is because the effect of the missing factor $\frac{1}{z^{2}}$ in the likelihood function used by the SVfitSA algorithm (\cf Section~\ref{sec:classicSVfit})
is equivalent to using an artificial regularization term with $\kappa = 4$.
The peaks of the $m_{\Pgt\Pgt}$ distributions reconstructed by the different versions of the SVfit algorithm are close to the true value of the mass of the $\Pgt$ lepton pair
in all event categories.
Adding an artificial regularization term has little effect on the peak of the $m_{\Pgt\Pgt}$ distribution.
The motivation for adding the artificial regularization term is to reduce the tail of the $m_{\Pgt\Pgt}$ distribution for the
$\PZ/\Pggx \to \Pgt\Pgt$ background in the mass range in which the signal is expected.
The improvement in sensitivity resulting from using a small positive $\kappa$ is quantified by the ratio of the number of signal over the square--root of the number of background events,
computed within a mass window containing $68\%$ of signal events.
The resolution on $m_{\Pgt\Pgt}$ achieved by the SVfit algorithm is best in the $1$-jet boosted and worst in the $0$-jet category.
Events in the $0$-jet category are the most difficult to reconstruct,
due to the fact that, in events in which the $\PHiggs$ or $\PZ$ boson has low $\pT$, 
the $\Pgt$ leptons are typically ``back-to-back'' in the transverse plane ($\Delta\phi_{\Pgt\Pgt} \approx \pi$),
with the effect that the neutrinos produced in the $\Pgt$ lepton decays are emitted in opposite hemispheres and their contribution to $\MET$ cancels.
The cancellation of neutrino momenta causes mass hypotheses of low $m_{\PHiggs}^{\textrm{test}(i)} \approx m_{\vis}$, corresponding to the case $z^{(1)} \approx 1$ and $z^{(2)} \approx 1$,
and of high $m_{\PHiggs}^{\textrm{test}(i)} \gg m_{\vis}$, corresponding to the case $z^{(1)} \ll 1$ and $z^{(2)} \ll 1$,
to be degenerate in terms of the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$,
computed according to Eq.~(\ref{eq:mem_with_hadRecoil}).
The best estimate for the mass of the $\Pgt$ lepton pair in a given event may fluctuate, 
depending on mismeasurements, within the experimental resolution, 
on the components $\pX^{\rec}$ and $\pY^{\rec}$ of the hadronic recoil or, to a lesser extent, on the $\pT$ of $\tauh$,
degrading the resolution on $m_{\Pgt\Pgt}$.
The variation of the resolution on $m_{\Pgt\Pgt}$ across event categories is most pronounced in the $\Pe\Pgm$ and least pronounced in the $\tauh\tauh$ decay channel.
This is because the fraction of $\Pgt$ lepton energy carried by the visible $\Pgt$ decay products is typically high for hadronic $\Pgt$ decays and typically low for leptonic $\Pgt$ decays,
\cf Fig.~\ref{fig:tauDecay_z}.
For events in the $\tauh\tauh$ decay channel the best estimate for the mass of the $\Pgt$ lepton pair is typically not much higher than $m_{\vis}$,
regardless of the angle $\Delta\phi_{\Pgt\Pgt}$ between the $\Pgt$ leptons,
as the energies of the neutrinos produced in hadronic $\Pgt$ decays are known to be most likely small.
For events in the $\Pe\Pgm$ decay channel on the other hand,
$\Pgt$ lepton decays with high energetic neutrinos are known to be likely,
provided they are compatible with the measured value of $\MET$.
In events in the $1$-jet and $2$-jet VBF categories,
in which the $\Pgt$ lepton pair typically recoils against high $\pT$ jets,
the angle $\Delta\phi_{\Pgt\Pgt}$ between the $\Pgt$ leptons decreases due to the Lorentz boost in direction of the $\PHiggs$ or $\PZ$ boson.
The momenta of the neutrinos produced in the $\Pgt$ lepton decays add constructively in this case,
with the effect that the mass of the $\Pgt$ lepton pair is constrained by the measured value of $\MET$.
The distribution in $\pT$ of the $\Pgt$ lepton pair and in
the angle $\Delta\phi_{\Pgt\Pgt}$ is shown in Fig.~\ref{fig:ditau_pT_and_dphi}
for SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to \Pgt\Pgt$ background events selected in the $\Pgm\tauh$ decay
channel.
The distributions for events selected in the $\tauh\tauh$ and $\Pe\Pgm$ decay channels are similar.

%----------------------------------------------------------------------------------------------------
%
% distributions in pT and deltaPhi of ditau system for SM Higgs->tautau signal and Z/gamma*->tautau background events
% selected in different event categories
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,152)(0,0)
%\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
%  {plots/Higgs_pT_muhad.pdf}}}
%\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
%  {plots/Higgs_dPhiTauTau_muhad.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/DYJets_pT_muhad.pdf}}}
%\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/DYJets_dPhiTauTau_muhad.pdf}}}
%\put(35.5, 75.0){\small (a)}
%\put(117.0, 75.0){\small (b)}
%\put(35.5, 0.0){\small (c)}
%\put(35.5, 150.0){\small (d)}
\end{picture}
\end{center}
\caption{
  Distributions in $\pT$ of the $\Pgt$ lepton pair (a,c) and in the
  angle $\Delta\phi_{\Pgt\Pgt}$ (b,d) for SM $\PHiggs \to \Pgt\Pgt$ signal (a,b)
  and $\PZ/\Pggx \to \Pgt\Pgt$ background (c,d) events,
  selected in the $\Pgm\tauh$ decay channel.
  The signal events shown in the $0$-jet, $1$-jet non--boosted and
  $1$-jet boosted categories ($2$-jet VBF category) are produced via the $\Pg\Pg \to \PHiggs$
  ($\Pquark\APquark \to \PHiggs$) production process.   
}
\label{fig:ditau_pT_and_dphi}
\end{figure}
%----------------------------------------------------------------------------------------------------

The resolution on $m_{\vis}$, quantified by the ratio $\sigma/\textrm{M}$,
varies across event categories between being worse by a factor $X.X$ to $X.X$ compared to $m_{\Pgt\Pgt}$ reconstructed by the SVfit algorithm.
The magnitude of the shift between $m_{\vis}$ and $m_{\Pgt\Pgt}^{\true}$ depends on the decay channel and on the event category.
The shift is largest in the $\Pe\Pgm$ channel and smallest in the $\tauh\tauh$ channel,
reflecting the difference between leptonic and hadronic $\Pgt$ decays in the fraction $z$ of $\Pgt$ lepton energy carried by the visible $\Pgt$ decay products.
The magnitude of the shift is reduced by the selection criteria on $\pT$.
The effect of $\pT$ thresholds differs by event category,
as, for fixed thresholds, $m_{\vis}$ decreases proportional to the cosine of the angle between the $\Pgt$ leptons,
$m_{\vis} \approx \pT^{\vis(1)} \, \cosh\eta_{\vis(1)} \cdot \pT^{\vis(2)} \, \cosh\eta_{\vis(2)} \cdot \left( 1 - \cos\sphericalangle(\Pgt,\Pgt) \right)$.
For events in the $0$-jet category, which contain mostly $\Pgt$ lepton pairs with $\Delta\phi_{\Pgt\Pgt} \approx \pi$,
the selection criteria on $\pT$ of the visible $\Pgt$ decay products remove events with $m_{\vis}$ below twice the higher $\pT$ threshold applied to either $\Pgt$ lepton,
while events of significantly lower $m_{\vis}$ may be selected in the $1$-jet and $2$-jet VBF categories in case they contain a $\PHiggs$ or $\PZ$ boson of high $\pT$.

The distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method exhibit pronounced high mass tails.
The tails are due to resolution effects and reduce the sensitivity of the SM $\PHiggs \to \Pgt\Pgt$ analysis,
as they cause a sizeable fraction of $\PZ/\Pggx \to \Pgt\Pgt$ background events
to be reconstructed near the signal region $m_{\Pgt\Pgt} \approx 125$~\GeV.
The resolution is worse for $m_{\Pgt\Pgt}$ reconstructed by the CA method compared to $m_{\vis}$.
A further disadvantage of the CA method is that it fails to yield a physical solution for approximately half of the events,
while all other algorithms provide a physical solution for every event.
The fraction of events for which the CA method fails to find a physical solution is reflected by the normalization of the distributions
in Figs.~\ref{fig:massDistributions_sm_tautau} to~\ref{fig:massDistributions_sm_emu}.

Compared to either $m_{\vis}$ or to $m_{\Pgt\Pgt}$ reconstructed by the CA method,
the SVfit algorithm significantly improves the separation of the SM $\PHiggs \to \Pgt\Pgt$ signal
from the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background.
In the SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$,
the use of $m_{\Pgt\Pgt}$ reconstructed by the SVfit algorithm
has increased the sensitivity for measuring the signal rate by $\approx 40\%$,
corresponding to a gain of a factor two in integrated luminosity of the analyzed dataset~\cite{HIG-13-004}.

Distributions in $m_{\Pgt\Pgt}$ reconstructed by different versions of
the SVfit algorithm, by the CA method, and of $m_{\vis}$ in heavy
pseudoscalar Higgs boson signal and $\PZ/\Pggx \to \Pgt\Pgt$
background events are shown in
Figs.~\ref{fig:massDistributions_mssm_tautau}
to~\ref{fig:massDistributions_mssm_emu}.
The distributions in $m_{\Pgt\Pgt}$ reconstructed by the cSVfit and
SVfitMEM algorithms are shown with and without the artificial regularization
term described in Section~\ref{sec:mem_logM}. 
The reduction of high mass tails in the $m_{\Pgt\Pgt}$ distribution
for the irreducible $\PZ/\Pggx \to \Pgt\Pgt$
background is important no only in the context of the SM $\PHiggs \to
\Pgt\Pgt$ analysis, but also for searches for heavy resonances, as the signal cross section is expected to fall steeply as function of resonance mass,
such that potential high mass signals would likely be buried underneath the high mass tail of the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background otherwise.
The axis of abscissae and the ordinate are drawn in logarithmic scale to better visualize differences in the high mass tails.

%----------------------------------------------------------------------------------------------------
%
% mTauTau distributions in MSSM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
%\put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu200_hadhad_log.pdf}}}
\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu300_hadhad_log.pdf}}}
\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu500_hadhad_log.pdf}}}
\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu800_hadhad_log.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu1200_hadhad_log.pdf}}}
\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_legend_hadhad.pdf}}}
\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\end{picture}
\end{center}
\caption{
  Distributions in alternative mass observables in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), and $1200$~\GeV (e).
  The events are selected in the $\tauh\tauh$ decay channel.
}
\label{fig:massDistributions_mssm_tautau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
%\put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu200_muhad_log.pdf}}}
\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu300_muhad_log.pdf}}}
\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu500_muhad_log.pdf}}}
\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu800_muhad_log.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu1200_muhad_log.pdf}}}
\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_legend_muhad.pdf}}}
\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\end{picture}
\end{center}
\caption{
  Distributions in alternative mass observables in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), and $1200$~\GeV (e).
  The events are selected in the $\Pgm\tauh$ decay channel.
}
\label{fig:massDistributions_mssm_mutau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
%\put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu200_emu_log.pdf}}}
\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu300_emu_log.pdf}}}
\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu500_emu_log.pdf}}}
\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu800_emu_log.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu1200_emu_log.pdf}}}
\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots/makeSVfitMEM_PerformancePlots_legend_emu.pdf}}}
\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\end{picture}
\end{center}
\caption{
  Distributions in alternative mass observables in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), and $1200$~\GeV (e).
  The events are selected in the $\Pe\Pgm$ decay channel.
}
\label{fig:massDistributions_mssm_emu}
\end{figure}
%----------------------------------------------------------------------------------------------------

The SVfit algorithm significantly improves the separation of the
heavy Higgs boson signal from the irreducible $\PZ/\Pggx \to \Pgt\Pgt$
background in all three decay channels.
Numerical values for the median $\textrm{M}$ and for the ratio $\sigma/\textrm{M}$ of the
distribution, are given in Tables~\ref{tab:resolutions_mssm_tautau}
to~\ref{tab:resolutions_mssm_emu}.
The Tables also give the median $\textrm{M}$ and ratio $\sigma/\textrm{M}$
for a heavy spin $1$ resonance.
We interpret the fact that the performance of the SVfitMEM and cSVfit algorithms is very similar for an $\PHiggsps \to \Pgt\Pgt$ signal of mass $2600$~\GeV
and for a $\PZ' \to \Pgt\Pgt$ signal of mass $2500$~\GeV as evidence that the choice of using
the LO ME for the gluon fusion process $\Pg\Pg \to \PHiggs$ in the SVfitMEM algorithm represents no limitation for using
the SVfitMEM algorithm in data analyses of $\Pgt$ lepton pair production other than studies of Higgs boson production.
The improvement in signal and background separation provided by the
SVfit algorithm is illustrated in Fig.~\ref{fig:distributions_mVis_vs_SVfit}.

%----------------------------------------------------------------------------------------------------
%
% mass resolutions in MSSM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=X$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed different versions of SVfit algorithm
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events (B) 
  and in signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$ (S).
  For the signal also the ratio $S/\sqrt{B}$,
  computed within a mass window containing $68\%$ of
  signal events and for a product of signal cross section times branching
  fraction of $1$~pb and, is given.
  The events are selected in the $\tauh\tauh$ decay channel.
}
\label{tab:resolutions_mssm_tautau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=X$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggsps} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggsps} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed different versions of SVfit algorithm
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events (B) 
  and in signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$ (S).
  For the signal also the ratio $S/\sqrt{B}$,
  computed within a mass window containing $68\%$ of
  signal events and for a product of signal cross section times branching
  fraction of $1$~pb and, is given.
  The events are selected in the $\Pgm\tauh$ decay channel.
}
\label{tab:resolutions_mssm_mutau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggs} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggs} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggs} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=X$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggs} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggs} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggs} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=2$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $S/\sqrt{B}$ \\
\hline
$\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PHiggs} = 200$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 300$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 500$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggs} = 800$~\GeV  & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 1200$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\ 
 $\quad m_{\PHiggs} = 1800$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
 $\quad m_{\PHiggs} = 2600$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\
 $\quad m_{\PZ'} = 2500$~\GeV & $XXX.X$ & $X.XXX$ & $X.XXX$ & $XXX.X$ & $X.XXX$ & $X.XXX$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed different versions of SVfit algorithm
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events (B) 
  and in signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$ (S).
  For the signal also the ratio $S/\sqrt{B}$,
  computed within a mass window containing $68\%$ of
  signal events and for a product of signal cross section times branching
  fraction of $1$~pb and, is given.
  The events are selected in the $\Pe\Pgm$ decay channel.
}
\label{tab:resolutions_mssm_emu}
\end{table}
%----------------------------------------------------------------------------------------------------

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,214)(0,0)
\put(-2.5, 150.0){\mbox{\includegraphics*[height=70mm]
  {plots/svFitPerformance_hadhad_visMass.pdf}}}
\put(80.0, 150.0){\mbox{\includegraphics*[height=70mm]
  {plots/svFitPerformance_hadhad_svFitMass.pdf}}}
\put(-2.5, 75.0){\mbox{\includegraphics*[height=70mm]
  {plots/svFitPerformance_muhad_visMass.pdf}}}
\put(80.0, 75.0){\mbox{\includegraphics*[height=70mm]
  {plots/svFitPerformance_muhad_svFitMass.pdf}}}
\put(-2.5, 0.0){\mbox{\includegraphics*[height=70mm]
  {plots/svFitPerformance_emu_visMass.pdf}}}
\put(80.0, 0.0){\mbox{\includegraphics*[height=70mm]
  {plots/svFitPerformance_emu_svFitMass.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\vis}$ (left) and in $m_{\Pgt\Pgt}$ reconstructed by the SVfitMEM algorithm with small positive $\kappa$ (right)
  in simulated $\PZ \to \Pgt\Pgt$ background events and $\PHiggs \to \Pgt\Pgt$ signal events,
  selected in the decay channels $\tauh\tauh$ ($\kappa = 3$, top), $\Pgm\tauh$ ($\kappa = 3$, centre), and $\Pe\Pgm$ ($\kappa = 2$, bottom).
  The signal events are generated for $\PHiggs$ boson masses of $m_{\PHiggs} = 125$, $200$, and $300$~\GeV. 
}
\label{fig:distributions_mVis_vs_SVfit}
\end{figure}

The performance of the cSVfit algorithm to reconstruct the $\pT$,
$\eta$, and $\phi$ of the $\Pgt$ lepton pair is studied in SM $\PHiggs
\to \Pgt\Pgt$ signal events produced via the gluon fusion process
and in $\PZ/\Pggx \to \Pgt\Pgt$ background events,
separately for the decay channels $\tauh\tauh$, $\Pgm\tauh$, and $\Pe\Pgm$.
Distributions of the difference between reconstructed and true $\pT$,
$\eta$, and $\phi$ of the $\PHiggs$ boson are shown in
Fig.~\ref{fig:resolutions_sm_pT_eta_and_phi}.
Compared to the case that the $\PHiggs$ boson $\pT$ and $\phi$ are
reconstructed by computing the sum of the momenta of the visible $\Pgt$
decay products and $\MET$, the cSVfit algorithm improves the
resolution by $10$--$20\%$. The pseudo--rapidity $\eta$ of the
$\PHiggs$ boson can only be reconstructed with the cSVfit algorithm.
Typical resolutions on the $\pT$, $\eta$, and $\phi$ of the $\PHiggs$ boson,
reconstructed by the cSVfit algorithm, amount to $X.X$~\GeV, $X.X$~\mrad, and $X.X$~\mrad,
respectively.

%----------------------------------------------------------------------------------------------------
%
% resolution in ditau pT, eta, and phi reconstructed by the cSVfit algorithm in SM Higgs->tautau signal events,
% compared to reconstructing the Higgs boson pT and phi by computing the sum of momenta of the visible tau decay products and MET
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(180,160)(0,0)
%\put(-2.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/Higgs_resolution_pT_hadhad.pdf}}}
%\put(57.5, 114.0){\mbox{\includegraphics*[height=46mm]
%  {plots/Higgs_resolution_eta_hadhad.pdf}}}
%\put(137.5, 114.0){\mbox{\includegraphics*[height=46mm] 
%  {plots/Higgs_resolution_phi_hadhad.pdf}}}
%\put(-2.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/Higgs_resolution_pT_muhad.pdf}}}
%\put(57.5, 58.0){\mbox{\includegraphics*[height=46mm]
%  {plots/Higgs_resolution_eta_muhad.pdf}}}
%\put(137.5, 58.0){\mbox{\includegraphics*[height=46mm] 
%  {plots/Higgs_resolution_phi_muhad.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/Higgs_resolution_pT_emu.pdf}}}
%\put(57.5, 2.0){\mbox{\includegraphics*[height=46mm]
%  {plots/Higgs_resolution_eta_emu.pdf}}}
%\put(137.5, 2.0){\mbox{\includegraphics*[height=46mm] 
%  {plots/Higgs_resolution_phi_emu.pdf}}}
\put( 27.5, 112.0){\small (a)}
\put( 87.5, 112.0){\small (b)}
\put(147.5, 112.0){\small (c)}
\put( 27.5,  56.0){\small (d)}
\put( 87.5,  56.0){\small (e)}
\put(147.5,  56.0){\small (f)}
\put( 27.5,   0.0){\small (g)}
\put( 87.5,   0.0){\small (h)}
\put(147.5,  0.0){\small (i)}
\end{picture}
\end{center}
\caption{
  Resolution on $\pT$ (a,d,g), $\eta$ (b,e,h), and $\phi$ (c,f,i) of the $\Pgt$ lepton
  pair in SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to
  \Pgt\Pgt$ background events,
  separately for the decay channels $\tauh\tauh$ (a,b,c), $\Pgm\tauh$ (d,e,f),
  and $\Pe\Pgm$ (g,h,i).
  The SM $\PHiggs \to \Pgt\Pgt$ signal events are produced via the
  gluon fusion process.
  The resolutions on $\pT$ and $\phi$ achieved by computing the sum of
  the momenta of the visible $\Pgt$ decay products and$\MET$ are shown for comparison.
}
\label{fig:resolutions_sm_pT_eta_and_phi}
\end{figure}
%----------------------------------------------------------------------------------------------------

We conclude the discussion of the performance of the SVfit algorithm
with a comparison of the computing time requirements of the SVfitMEM,
cSVfit, and SVfitSA algorithms.
The computing time is dominated by the
evaluation of the integrand during the numeric integration.
The requirement on the computing time is expected to be
highest for the SVfitMEM algorithm, arising from the additional evaluation of the PDF and of the TF in Eq.~(\ref{eq:mem_with_hadRecoil}).
The time for reconstructing $m_{\Pgt\Pgt}$ in a single event scales approximately linearly
with the number of evaluations of the integrand.
The SVfitMEM (SVfitSA) algorithm performs $20,000$ ($10,000$)
evaluations of the integrand per mass hypothesis
$m_{\PHiggs}^{\textrm{test}(i)}$.
The number of mass hypotheses tested for an event varies depending on the
conditions described in Section~\ref{sec:mem_numericalMaximization}.
Due to the fact that the series of mass hypotheses is given by a
recursive relation,
defined by Eq.~(\ref{eq:mTauTau_step_size}), the number of test mass
hypotheses increases approximately logarithmically with the
true mass of the $\Pgt$ lepton pair. 
For signal events the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$
is typically computed for a series of $20$--$30$ mass hypotheses $m_{\PHiggs}^{\textrm{test}(i)}$.
Background events may require to compute $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$ for a larger number of test mass hypotheses,
as the probability density may be almost degenerate over a large range in $m_{\PHiggs}^{\textrm{test}(i)}$.
The number of evaluations of the integrand that is performed for a single event is chosen such that the
an almost optimal resolution is achieved, within less than $1\%$ relative to
the case that an infinite (very large) number of evaluations of the
integrand is performed.
The number of evaluations of the integrand is higher for the SVfitMEM
compared to the SVfitSA algorithm, to account for the fact that the additional PDF and TF factors
raise the variation of the integrand,
which requires a higher numerical precision of the integration in
order to reliably determine the maximum $\mathcal{P}^{\textrm{max}}$ of the probability density.
The numeric integration is performed by the VAMP algorithm in case of
the SVfitMEM algorithm (\cf Section~\ref{sec:mem_numericalMaximization}) and by the VEGAS algorithm
in case of the SVfitSA algorithm.
In case of the cSVfit algorithm, the numeric integration is performed
by a custom implementation of the Markov chain Monte Carlo method, as described in Section~\ref{sec:classicSVfit}.
In the latter case, the integrand is evaluated $100,000$ times per event and there is no
iteration over a sequence of mass hypotheses.
The computing time is measured by CPU time, 
using a single core of a $X.XX$~GHz Intel\TReg~Xeon\TReg~XXXX processor.
The distribution of the computing time, in units of seconds per event, 
spent to compute $m_{\Pgt\Pgt}$
in SM SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to \Pgt\Pgt$ background events
using the SVfitMEM, cSVfit and SVfitSA algorithms is shown in
Fig.~\ref{fig:computing_time}.
The cSVfit algorithm requires about $1$~s of CPU time per event.
Within this time, the mass $m_{\Pgt\Pgt}$ of the $\Pgt$ lepton pair,
as well as its $\pT$, $\eta$, $\phi$, and transverse mass
$m_{T\Pgt\Pgt}$ are reconstructed.
Compared to the SVfitSA algorithm, the cSVfit algorithm reduces the
computing time by a factor $2$--$3$. 
The reduction in computing time is
due to the more efficient Markov chain Monte
Carlo integration method, compared to
computing the probability density
$\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$
for a series of mass hypotheses.
Compared to the cSVfit algorithm, the computing time requirement of the SVfitMEM algorithm is higher
by about one order of magnitude. 
Considering that the resolution on $m_{\Pgt\Pgt}$,
quantified by the ratio $\sigma/\textrm{M}$, achieved
by the SVfitMEM and cSVfit algorithms is almost identical, we find that the cSVfit
algorithm represents the best compromise between physics performance and computing time requirements.
The merit of the SVfitMEM algorithm is that the 
formalism to treat $\Pgt$ lepton decays in the ME method, developed
for the SVfitMEM algorithm, can be used
in future applications of the ME method to data analyses with $\Pgt$
leptons in the final state.

%----------------------------------------------------------------------------------------------------
%
% computing time requirements of the SVfitMEM, cSVfit, and SVfitSA in SM Higgs->tautau signal and Z/gamma*->tautau background events 
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
%\put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
%  {plots/Higgs_cpuTime_hadhad.pdf}}}
%\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
%  {plots/DYJets_cpuTime_hadhad.pdf}}}
%\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
%  {plots/Higgs_cpuTime_muhad.pdf}}}
%\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
%  {plots/DYJets_cpuTime_muhad.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/Higgs_cpuTime_emu.pdf}}}
%\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots/DYJets_cpuTime_emu.pdf}}}
\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\put(117.0, 0.0){\small (f)}
\end{picture}
\end{center}
\caption{
  CPU time per event required for reconstruction of $m_{\Pgt\Pgt}$ by
  the SVfitMEM, cSVfit, and SVfitSA algorithms
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (a,c,e)
  and $\PZ/\Pggx \to \Pgt\Pgt$ background (b,d,f) events
  in the decay channels $\tauh\tauh$ (a,b), $\Pgm\tauh$ (c,d),
  and $\Pe\Pgm$ (e,f).
}
\label{fig:computing_time}
\end{figure}
%----------------------------------------------------------------------------------------------------
