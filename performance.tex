\section{Performance}
\label{sec:performance}

The performance of the $m_{\Pgt\Pgt}$ reconstruction is studied in simulated events.
Samples of SM $\PHiggs \to \Pgt\Pgt$ signal events
are generated with the next-to-leading-order (NLO) program POWHEG v2~\cite{POWHEG1,POWHEG2,POWHEG3}
for a $\PHiggs$ boson of mass $m_{\PHiggs} = 125$~\GeV 
and for the gluon fusion ($\Pg\Pg \to \PHiggs$) and vector boson fusion ($\Pquark\APquark \to \PHiggs$) production processes.
We also study the $m_{\Pgt\Pgt}$ reconstruction in events containing
heavy pseudoscalar Higgs bosons $\PHiggsps$ of mass $m_{\PHiggsps} = 200$, $300$, $500$, $800$, $1200$, $1800$, and $2600$~\GeV,
produced via gluon fusion, and in events containing heavy spin $1$
resonances, of mass $2500$~\GeV, that decay into $\Pgt$ pairs.
We denote the latter by the symbol $\PZ'$. 
The $\PHiggsps \to \Pgt\Pgt$ and $\PZ' \to \Pgt\Pgt$ signal samples are generated with the LO generator PYTHIA 8.2~\cite{pythia8}.
The $\PZ/\Pggx \to \Pgt\Pgt$ background sample is generated with the LO MadGraph program, in the version MadGraph\_aMCatNLO 2.2.2~\cite{MadGraph_aMCatNLO}.
The sample contains $\Pgt$ lepton pairs of true mass $m_{\Pgt\Pgt}^{\true} > 50$~\GeV.
Most of the $\Pgt$ lepton pairs have a mass near the $\PZ$ peak at $m_{\PZ} = 91.2$~GeV and width $\Gamma_{\PZ} = 2.5$~\GeV~\cite{PDG}, 
but the sample also contains events of significantly higher mass.
Drell--Yan events of mass $m_{\Pgt\Pgt}^{\true} < 50$~\GeV are not relevant for this study, 
because they do not pass the selection criteria on $\pT$ and $\eta$ that are applied on analysis level.
All events are generated for proton-proton collisions at $\sqrt{s} = 13$~\TeV centre-of-mass energy.
The samples produced by MadGraph and POWHEG are generated with the NNPDF3.0 set of parton distribution functions,
while the samples produced by PYTHIA use the NNPDF2.3LO set~\cite{NNPDF1,NNPDF2,NNPDF3}.
Parton shower and hadronization processes are modelled using the generator PYTHIA with the tune CUETP8M1~\cite{PYTHIA_CUETP8M1tune_CMS}.
The latter is based on the Monash tune~\cite{PYTHIA_MonashTune}.
The decays of $\Pgt$ leptons, including polarization effects, are modelled by PYTHIA.
The samples are normalized according to cross section for the purpose of comparing different mass reconstruction algorithms in terms of signal-to-background separation.
The cross section of the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background is computed at NNLO accuracy and amounts to $1.92 \times 10^{3}$~pb~\cite{FEWZ}.
The cross sections for the SM $\PHiggs \to \Pgt\Pgt$ signal have been computed as detailed in Ref.~\cite{Dittmaier:2011ti},
with the updates described in Ref.~\cite{Heinemeyer:2013tqa} included.
They amount to $43.9$~pb for the $\Pg\Pg \to \PHiggs$ and to $3.75$~pb for the $\Pquark\APquark \to \PHiggs$ production process.
The $\PHiggsps \to \Pgt\Pgt$ and $\PZ' \to \Pgt\Pgt$ samples 
are scaled to a product of cross section times branching fraction, for the decay into $\Pgt$ lepton pairs, of $1$~pb.

The experimental resolutions on the $\pT$ of $\tauh$ and on the $\pX^{\rec}$ and $\pY^{\rec}$ of the hadronic recoil 
are simulated by sampling from the TF described in
Sections~\ref{sec:mem_TF_tauToHadDecays}
and~\ref{sec:mem_TF_hadRecoil}.
The $\eta$, $\phi$, and $m_{\vis}$ of $\tauh$,
as well as the $\pT$, $\eta$, and $\phi$ of electrons and muons are assumed to be reconstructed perfectly.

Distributions in $m_{\Pgt\Pgt}$ are computed separately for events in which 
both $\Pgt$ leptons decay hadronically ($\tauh\tauh$), 
events in which one $\Pgt$ lepton decays hadronically and the other into a muon ($\Pgm\tauh$),
and events in which one $\Pgt$ lepton decays into a muon and the other into an electron ($\Pe\Pgm$).
The visible $\Pgt$ decay products are required to pass selection criteria on $\pT$ and $\eta$,
which are motivated by the SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$~\cite{HIG-13-004}.
Events in the $\tauh\tauh$ decay channel are required to contain
two $\tauh$ of $\pT > 45$~\GeV and $\vert\eta\vert < 2.1$.
Events in the $\Pgm\tauh$ channel
are required to contain a muon of $\pT > 20$~\GeV and $\vert\eta\vert < 2.1$ and a $\tauh$ of $\pT > 30$~\GeV and $\vert\eta\vert < 2.3$.
Events selected in the $\Pe\Pgm$ channel are required to contain a muon with $\vert\eta\vert < 2.1$ and an electron with $\vert\eta\vert < 2.4$.
The lepton of higher $\pT$ (either the electron or the muon) is required to satisfy the condition $\pT > 20$~\GeV,
while the lepton of lower $\pT$ is required to satisfy $\pT > 10$~\GeV.
Similar selection criteria on $\pT$ and $\eta$ of the visible $\Pgt$ decay products were applied in the $\PHiggs \to \Pgt\Pgt$
analyses performed by the ATLAS
collaboration during LHC Run $1$~\cite{ATLAS_HiggsTauTau_SM,ATLAS_HiggsTauTau_MSSM}.

The $m_{\Pgt\Pgt}$ reconstruction in SM $\PHiggs \to \Pgt\Pgt$ signal events is studied in event categories motivated by the
SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$~\cite{HIG-13-004}:
\begin{itemize}
\item $0$-jet: 
  Events containing no jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$.
\item $1$-jet non-boosted:
  Events containing one or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$
  in which the $\PHiggs$ (respectively $\PZ$) boson satisfies $\pT < 100$~\GeV and that are not selected in the $2$-jet VBF event category.
\item $1$-jet boosted:
  Events containing one or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$
  in which the $\PHiggs$ (respectively $\PZ$) boson satisfies $\pT > 100$~\GeV and that are not selected in the $2$-jet VBF event category.
\item $2$-jet VBF:
  Events containing two or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$,
  with at least one pair of jets satisfying $m_{jj} > 500$~\GeV and $\Delta\eta_{jj} > 3.5$.
\end{itemize}
The event categorization is based on generator level quantities.

The $m_{\Pgt\Pgt}$ distributions reconstructed by the SVfitMEM and cSVfit algorithms in these event categories 
in the $\tauh\tauh$, $\Pgm\tauh$, and $\Pe\Pgm$ decay channels are shown in Figs.~\ref{fig:massDistributions_sm_tautau} to~\ref{fig:massDistributions_sm_emu}.
They are compared to the distributions in $m_{\Pgt\Pgt}$  reconstructed by the previous version of the
SVfit algorithm, described in Ref.~\cite{SVfit}, to which we refer to as the SVfit ``standalone'' (SVfitSA) algorithm,
and by the ``collinear-approximation'' (CA) method~\cite{massRecoCollinearApprox}.
The SVfitMEM and cSVfit algorithms are run with and without the artificial regularization term described in Section~\ref{sec:mem_logM}.
The value of $\kappa$ used for each channel is chosen such that the optimal resolution on $m_{\Pgt\Pgt}$, 
quantified in terms of the ratio of the standard deviation $\sigma$ to the median $\textrm{M}$ of the distribution,
is attained.
We find that the choice of $\kappa = 5$ for the $\tauh\tauh$ channel, $\kappa = 4$ for the $\Pgm\tauh$ channel,
and $\kappa = 3$ for the $\Pe\Pgm$ channel performs well for the SVfitMEM and for the cSVfit algorithm.

%----------------------------------------------------------------------------------------------------
%
% mTauTau distributions in SM Higgs->tautau signal and Z/gamma*->tautau background events
%

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,212)(0,0)
\put(-4.0, -4.0){\mbox{\includegraphics*[height=216mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_DYJets_HiggsSM_all_categories_hadhad_log_ratio.pdf}}}
\put(117.5, 145.5){\mbox{\includegraphics*[width=52mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_legend_hadhad.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by different algorithms in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background ground events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non-boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\tauh\tauh$ decay channel. 
  The axis of abscissae ranges from $0.4$ to $8$.
}
\label{fig:massDistributions_sm_tautau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,212)(0,0)
\put(-4.0, -4.0){\mbox{\includegraphics*[height=216mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_DYJets_HiggsSM_all_categories_muhad_log_ratio.pdf}}}
\put(117.5, 145.5){\mbox{\includegraphics*[width=52mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_legend_muhad.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by different algorithms in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background ground events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non-boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\Pgm\tauh$ decay channel. 
  The axis of abscissae ranges from $0.4$ to $8$.
}
\label{fig:massDistributions_sm_mutau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,212)(0,0)
\put(-4.0, -4.0){\mbox{\includegraphics*[height=216mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_DYJets_HiggsSM_all_categories_emu_log_ratio.pdf}}}
\put(117.5, 145.5){\mbox{\includegraphics*[width=52mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_legend_emu.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by different algorithms in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background ground events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non-boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\Pe\Pgm$ decay channel.
  The axis of abscissae ranges from $0.4$ to $8$.
}
\label{fig:massDistributions_sm_emu}
\end{figure}
%----------------------------------------------------------------------------------------------------

The distributions in $m_{\Pgt\Pgt}$ reconstructed by the cSVfit and SVfitMEM algorithms with artificial regularization term
and by the SVfitSA algorithm are very similar.
The SVfitSA algorithm performs well without adding an artificial regularization term of the type described in Section~\ref{sec:mem_logM} to its likelihood function.
This is because the effect of the missing factor $\frac{1}{z^{2}}$ in the likelihood function used by the SVfitSA algorithm (\cf Section~\ref{sec:classicSVfit})
is equivalent to using an artificial regularization term with $\kappa = 4$.
Regardless of the choice of $\kappa$, the peaks of the $m_{\Pgt\Pgt}$ distributions reconstructed by the different versions of the SVfit algorithm are close to the true value of the mass of the $\Pgt$ lepton pair
in all event categories.
Adding an artificial regularization term has little effect on the peak of the $m_{\Pgt\Pgt}$ distribution.
The motivation for adding the artificial regularization term is to reduce the tail of the $m_{\Pgt\Pgt}$ distribution for the
$\PZ/\Pggx \to \Pgt\Pgt$ background in the mass range in which the signal is expected.

The effect of adding the artificial regularization term is largest for events reconstructed in the $0$-jet category.
Events in the $0$-jet category are the most difficult to reconstruct.
This is because the $\Pgt$ leptons are typically ``back-to-back'' in the transverse plane ($\Delta\phi_{\Pgt\Pgt} \approx \pi$)
in events in which the $\PHiggs$ or $\PZ$ boson has low $\pT$, 
with the effect that the neutrinos produced in the $\Pgt$ lepton decays are emitted in opposite hemispheres and their contribution to $\MET$ cancels.
The cancellation of neutrino momenta causes mass hypotheses of low $m_{\PHiggs}^{\textrm{test}(i)} \approx m_{\vis}$
and of high $m_{\PHiggs}^{\textrm{test}(i)} \gg m_{\vis}$
to be degenerate in terms of the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$,
computed according to Eq.~(\ref{eq:mem_with_hadRecoil}).
In this case, the best estimate for the mass of the $\Pgt$ lepton pair in a given event may fluctuate, 
depending on mismeasurements, within the experimental resolution, 
on the components $\pX^{\rec}$ and $\pY^{\rec}$ of the hadronic recoil or, to a lesser extent, on the $\pT$ of $\tauh$,
degrading the resolution on $m_{\Pgt\Pgt}$.

The resolution on $m_{\Pgt\Pgt}$ typically improves with the $\pT$ of the $\PHiggs$ respectively $\PZ$ boson.
In events in the $1$-jet and $2$-jet VBF categories,
in which the $\Pgt$ lepton pair typically recoils against high $\pT$ jets,
the angle $\Delta\phi_{\Pgt\Pgt}$ between the $\Pgt$ leptons decreases due to the Lorentz boost in direction of the $\PHiggs$ or $\PZ$ boson.
The momenta of the neutrinos produced in the $\Pgt$ lepton decays add constructively in this case,
with the effect that the mass of the $\Pgt$ lepton pair is constrained by the measured value of $\MET$.
The distribution in $\pT$ of the $\Pgt$ lepton pair and in the angle $\Delta\phi_{\Pgt\Pgt}$ is shown in Fig.~\ref{fig:ditau_pT_and_dphi}
for SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to \Pgt\Pgt$ background events.
The events are selected in the $\Pgm\tauh$ decay channel.
The distributions for events selected in the $\tauh\tauh$ and $\Pe\Pgm$ decay channels are similar.

%----------------------------------------------------------------------------------------------------
%
% distributions in pT and deltaPhi of ditau system for SM Higgs->tautau signal and Z/gamma*->tautau background events
% selected in different event categories
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\includegraphics*[height=70mm]{plots_sept_16/Higgs_pT_muhad.pdf}
\includegraphics*[height=70mm]{plots_sept_16/Higgs_dPhiTauTau_muhad.pdf}\\
\includegraphics*[height=70mm]{plots_sept_16/DYJets_pT_muhad.pdf}
\includegraphics*[height=70mm]{plots_sept_16/DYJets_dPhiTauTau_muhad.pdf}
%\begin{picture}(160,152)(0,0)
%\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
%  {plots_sept_16/Higgs_pT_muhad.pdf}}}
%\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
%  {plots_sept_16/Higgs_dPhiTauTau_muhad.pdf}}}
%\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots_sept_16/DYJets_pT_muhad.pdf}}}
%\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
%  {plots_sept_16/DYJets_dPhiTauTau_muhad.pdf}}}
%\put(35.5, 75.0){\small (a)}
%\put(117.0, 75.0){\small (b)}
%\put(35.5, 0.0){\small (c)}
%\put(117.5, 0.0){\small (d)}
%\end{picture}
\end{center}
\caption{
  Distributions in $\pT$ of the $\PHiggs$ respectively $\PZ$ boson (a,c) and in the
  angle $\Delta\phi_{\Pgt\Pgt}$ (b,d) for SM $\PHiggs \to \Pgt\Pgt$ signal (a,b)
  and $\PZ/\Pggx \to \Pgt\Pgt$ background (c,d) events,
  selected in the $\Pgm\tauh$ decay channel.
  The signal events shown in the $0$-jet, $1$-jet non-boosted and
  $1$-jet boosted categories ($2$-jet VBF category) are produced via the $\Pg\Pg \to \PHiggs$
  ($\Pquark\APquark \to \PHiggs$) production process.   
}
\label{fig:ditau_pT_and_dphi}
\end{figure}
%----------------------------------------------------------------------------------------------------

The variation of the resolution on $m_{\Pgt\Pgt}$ across event categories is most pronounced in the $\Pe\Pgm$ and least pronounced in the $\tauh\tauh$ decay channel.
This is because the fraction of $\Pgt$ lepton energy carried by the visible $\Pgt$ decay products is typically high for hadronic $\Pgt$ decays and typically low for leptonic $\Pgt$ decays,
\cf Fig.~\ref{fig:tauDecay_z}.
For events in the $\tauh\tauh$ decay channel the best estimate for the mass of the $\Pgt$ lepton pair is typically not much higher than $m_{\vis}$,
regardless of the angle $\Delta\phi_{\Pgt\Pgt}$ between the $\Pgt$ leptons,
as the energies of the neutrinos produced in hadronic $\Pgt$ decays are known to be most likely small.
For events in the $\Pe\Pgm$ decay channel on the other hand,
$\Pgt$ lepton decays with high energetic neutrinos are known to be likely,
provided they are compatible with the measured value of $\MET$,
causing mass hypotheses of low $m_{\PHiggs}^{\textrm{test}(i)} \approx m_{\vis}$ (corresponding to the case $z^{(1)} \approx 1$ and $z^{(2)} \approx 1$)
and of high $m_{\PHiggs}^{\textrm{test}(i)} \gg m_{\vis}$ (corresponding to the case $z^{(1)} \ll 1$ and $z^{(2)} \ll 1$)
to be more degenerate in terms of the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$
compared to the $\tauh\tauh$ and $\Pgm\tauh$ channels.

Numerical values for the resolution in $m_{\Pgt\Pgt}$ achieved by the different algorithms are given in Tables~\ref{tab:resolutions_sm_tautau} to~\ref{tab:resolutions_sm_emu}.
The mass of the visible $\Pgt$ decay products, $m_{\vis}$, is given in the tables for comparison.
The resolution is quantified in terms of $\sigma/\textrm{M}$, the root-mean-square (RMS) $\sigma$ of each distribution relative to its median $\textrm{M}$,
and in terms of $\textrm{S}/(\textrm{S} + \textrm{B})$, the ratio of the number $\textrm{S}$ of SM $\PHiggs \to \Pgt\Pgt$ signal events to the sum $\textrm{S} + \textrm{B}$ of signal plus $\PZ/\Pggx \to \Pgt\Pgt$ background events.
The signal and background event yields are computed within a mass window containing $68\%$ of signal events,
with $16\%$ of signal events on either side of the mass window.
The $\textrm{S}$ and $\textrm{B}$ event yields are determined for SM signal and background cross sections.

%----------------------------------------------------------------------------------------------------
%
% mass resolutions in SM Higgs->tautau signal and Z/gamma*->tautau background events,
% in event categories motivated by Run 1 SM Higgs->tautau analysis
%
\begin{table}
\begin{center}
%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multicolumn{7}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $100.0$ & $ 0.089$ & $-$ &  $117.9$ & $ 0.096$ & $-$  \\
        $\quad$ $1$-jet non-boosted &  $86.3 $ & $ 0.129$ & $-$ &  $101.6$ & $ 0.137$ & $-$  \\
        $\quad$ $1$-jet boosted      &  $70.1 $ & $ 0.188$ & $-$ &  $90.4 $ & $ 0.112$ & $-$  \\
        $\quad$ $2$-jet VBF          &  $66.7 $ & $ 0.200$ & $-$ &  $90.7 $ & $ 0.101$ & $-$  \\

    SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $109.2$ & $ 0.091$ & $14.41\pm0.50$ &  $130.0$ & $ 0.096$ & $16.05\pm1.13 $ \\
        $\quad$ $1$-jet non-boosted &  $107.3$ & $ 0.108$ & $17.73\pm0.43$ &  $129.1$ & $ 0.104$ & $25.13\pm1.56 $  \\
        $\quad$ $1$-jet boosted      &  $92.4 $ & $ 0.188$ & $3.76\pm0.08 $ &  $122.8$ & $ 0.094$ & $33.45\pm2.07 $  \\

    SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & &  \\
        $\quad$ $2$-jet VBF          &  $94.6$  & $ 0.185$ & $21.26\pm0.44$  &  $123.4$ & $ 0.100$ & $84.62\pm7.52$  \\
\hline
\end{tabular}

%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=5$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $128.8$ & $ 0.340$ & $-$     &  $115.6$ & $ 0.097$ & $-$  \\
 $\quad$ $1$-jet non-boosted &  $104.7$ & $ 0.156$ & $-$     &  $99.8$  & $ 0.134$ & $-$  \\
 $\quad$ $1$-jet boosted      &  $91.9 $ & $ 0.112$ & $-$     &  $90.0$  & $ 0.112$ & $-$  \\
 $\quad$ $2$-jet VBF          &  $91.9 $ & $ 0.103$ & $-$     &  $89.4$  & $ 0.102$ & $-$  \\
 SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $143.6$ & $ 0.217$ & $16.09\pm1.14$ &  $127.6$ & $ 0.093$ & $16.38\pm1.16$ \\
 $\quad$ $1$-jet non-boosted &  $136.8$ & $ 0.135$ & $25.46\pm1.60$ &  $126.5$ & $ 0.102$ & $24.57\pm1.53$  \\
 $\quad$ $1$-jet boosted      &  $124.7$ & $ 0.094$ & $33.82\pm2.10$ &  $121.2$ & $ 0.096$ & $34.84\pm2.17$  \\
 SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $125.7$ & $ 0.109$ & $73.36\pm7.99$ &  $121.6$ & $ 0.100$ & $80.65\pm7.81$  \\
\hline
\end{tabular}

%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=5$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $128.1$  & $ 0.159$ & $-$     &  $115.6$ & $ 0.101$ & $-$  \\
        $\quad$ $1$-jet non-boosted &  $104.8$  & $ 0.152$ & $-$     &  $99.8$  & $ 0.133$ & $-$  \\
        $\quad$ $1$-jet boosted      &  $91.8 $  & $ 0.112$ & $-$     &  $89.1$  & $ 0.113$ & $-$  \\
        $\quad$ $2$-jet VBF          &  $91.9 $  & $ 0.102$ & $-$     &  $89.1$  & $ 0.102$ & $-$  \\
        SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $142.2$ & $ 0.878$ & $14.98\pm1.03$ &  $127.9$ & $ 0.097$ & $16.46\pm1.17$  \\
        $\quad$ $1$-jet non-boosted &  $136.5$ & $ 0.800$ & $24.77\pm1.55$ &  $127.0$ & $ 0.104$ & $23.38\pm1.44$  \\
        $\quad$ $1$-jet boosted      &  $124.8$ & $ 0.093$ & $34.93\pm2.17$ &  $121.3$ & $ 0.095$ & $33.95\pm2.12$  \\
        SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $2$-jet VBF          &  $125.6$ & $ 0.243$ & $84.66\pm7.50$ &  $121.9$ & $ 0.101$ & $76.81\pm7.97$  \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (S) and $\PZ/\Pggx \to \Pgt\Pgt$ background (B) and events 
  selected in different event categories in the $\tauh\tauh$ decay channel.
  The improvement in signal-to-background separation is quantified also by the ratio $S/(S+B)$,
  computed within a mass window containing $68\%$ of signal events, as explained in the text.
}
\label{tab:resolutions_sm_tautau}
\end{table}

\begin{table}
\begin{center}
%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multicolumn{7}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $66.8$ & $ 0.135$ & $-$      &  $95.4$ & $ 0.134$  & $-$  \\
        $\quad$ $1$-jet non-boosted &  $64.7$ & $ 0.157$ & $-$      &  $94.5$ & $ 0.135$  & $-$  \\
        $\quad$ $1$-jet boosted      &  $53.3$ & $ 0.253$ & $-$      &  $90.4$ & $ 0.115$  & $-$  \\
        $\quad$ $2$-jet VBF          &  $56.0$ & $ 0.272$ & $-$      &  $92.5$ & $ 0.134$  & $-$  \\
        SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $80.6$ & $ 0.179$ & $0.80\pm0.01$  &  $119.4$ & $ 0.167$ & $1.17\pm0.02$  \\
        $\quad$ $1$-jet non-boosted &  $79.8$ & $ 0.194$ & $1.63\pm0.02$  &  $122.7$ & $ 0.141$ & $4.56\pm0.22$  \\
        $\quad$ $1$-jet boosted      &  $71.4$ & $ 0.267$ & $1.97\pm0.02$  &  $124.5$ & $ 0.103$ & $27.96\pm3.89$  \\
        SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: &  & & & & & \\
        $\quad$ $2$-jet VBF          &  $74.2$ & $ 0.248$ & $12.65\pm0.13$  &  $122.8$ & $ 0.117$ & $57.50\pm14.11$  \\
\hline
\end{tabular}

%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=4$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $121.6$ & $ 0.859$ & $-$     &  $94.8$ & $ 0.136$ & $-$  \\
        $\quad$ $1$-jet non-boosted &  $103.5$ & $ 0.258$ & $-$     &  $93.7$ & $ 0.135$ & $-$  \\
        $\quad$ $1$-jet boosted      &  $92.1$  & $ 0.119$ & $-$     &  $89.8$ & $ 0.116$ & $-$  \\
        $\quad$ $2$-jet VBF          &  $94.5$  & $ 0.251$ & $-$     &  $91.8$ & $ 0.130$ & $-$  \\
        SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $150.6$ & $ 0.772$ & $1.06\pm0.02$  &  $119.2$ & $ 0.165$ & $ 1.12\pm0.02$  \\
        $\quad$ $1$-jet non-boosted &  $136.4$ & $ 0.412$ & $4.12\pm0.19$  &  $122.3$ & $ 0.148$ & $ 4.68\pm0.23$  \\
        $\quad$ $1$-jet boosted      &  $125.4$ & $ 0.107$ & $26.55\pm3.63$ &  $122.1$ & $ 0.103$ & $ 28.79\pm4.03$  \\
        SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $2$-jet VBF          &  $127.3$ & $ 0.342$ & $40.35\pm9.83$ &  $122.0$ & $ 0.116$ & $ 57.85\pm14.08$  \\
\hline
\end{tabular}

%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=4$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $116.4$ & $ 0.343$ & $-$     &  $94.0$ & $ 0.138$ & $-$  \\
        $\quad$ $1$-jet non-boosted &  $102.8$ & $ 0.220$ & $-$     &  $92.8$ & $ 0.139$ & $-$  \\
        $\quad$ $1$-jet boosted      &  $92.5$  & $ 0.121$ & $-$     &  $89.5$ & $ 0.117$ & $-$  \\
        $\quad$ $2$-jet VBF          &  $94.0$  & $ 0.177$ & $-$     &  $91.5$ & $ 0.135$ & $-$  \\
        SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $145.3$ & $ 0.362$ & $1.06\pm0.02$  &  $118.4$ & $ 0.165$ & $ 1.13\pm0.02$  \\
        $\quad$ $1$-jet non-boosted &  $135.4$ & $ 0.242$ & $4.13\pm0.19$  &  $121.6$ & $ 0.148$ & $ 4.57\pm0.22$  \\
        $\quad$ $1$-jet boosted      &  $124.5$ & $ 0.106$ & $27.33\pm3.77$ &  $122.1$ & $ 0.104$ & $ 29.02\pm4.05$  \\
        SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $2$-jet VBF          &  $127.5$ & $ 0.185$ & $44.90\pm11.07$ &  $121.9$ & $ 0.116$ & $ 57.54\pm14.11$  \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (S) and $\PZ/\Pggx \to \Pgt\Pgt$ background (B) and events 
  selected in different event categories in the $\Pgm\tauh$ decay channel.
  The improvement in signal-to-background separation is quantified also by the ratio $S/(S+B)$,
  computed within a mass window containing $68\%$ of signal events, as explained in the text.
}
\label{tab:resolutions_sm_mutau}
\end{table}

\begin{table}
\begin{center}
%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multicolumn{7}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $48.1$ & $ 0.229$ & $-$ &  $88.2$ & $ 0.219$ & $-$  \\
        $\quad$ $1$-jet non-boosted &  $47.0$ & $ 0.237$ & $-$ &  $89.5$ & $ 0.189$ & $-$  \\
        $\quad$ $1$-jet boosted      &  $38.3$ & $ 0.364$ & $-$ &  $90.1$ & $ 0.140$ & $-$  \\
        $\quad$ $2$-jet VBF          &  $41.0$ & $ 0.306$ & $-$ &  $89.3$ & $ 0.149$ & $-$  \\
        SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $0$-jet              &  $55.6$ & $ 0.274$ & $0.31\pm0.00$ &  $108.4$ & $ 0.260$ & $0.34\pm0.01$  \\
        $\quad$ $1$-jet non-boosted &  $55.2$ & $ 0.281$ & $0.61\pm0.01$ &  $117.3$ & $ 0.209$ & $1.01\pm0.03$  \\
        $\quad$ $1$-jet boosted      &  $49.7$ & $ 0.352$ & $1.33\pm0.02$ &  $123.4$ & $ 0.123$ & $15.73\pm2.62$  \\
        SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
        $\quad$ $2$-jet VBF          &  $51.2$ & $ 0.332$ & $5.62\pm0.06$ &  $122.1$ & $ 0.159$ & $46.28\pm17.58$ \\
\hline
\end{tabular}

%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $159.8$ & $ 1.646$ & $-$ &  $92.8$ & $ 0.240$ & $-$  \\
 $\quad$ $1$-jet non-boosted &  $106.9$ & $ 1.098$ & $-$ &  $92.0$ & $ 0.207$ & $-$  \\
 $\quad$ $1$-jet boosted      &  $92.6$  & $ 0.187$ & $-$ &  $90.1$ & $ 0.136$ & $-$  \\
 $\quad$ $2$-jet VBF          &  $95.5$  & $ 0.818$ & $-$ &  $89.8$ & $ 0.148$ & $-$  \\
 SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $174.4$ & $ 1.352$ & $0.39\pm0.01$  &  $114.7$ & $ 0.274$ & $0.35\pm0.01$  \\
 $\quad$ $1$-jet non-boosted &  $140.2$ & $ 0.884$ & $1.43\pm0.06$  &  $120.6$ & $ 0.208$ & $1.13\pm0.04$  \\
 $\quad$ $1$-jet boosted      &  $127.1$ & $ 0.408$ & $14.37\pm2.30$ &  $123.2$ & $ 0.124$ & $15.73\pm2.62$  \\
 SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $129.2$ & $ 0.687$ & $46.39\pm17.59$ &  $122.7$ & $ 0.160$  & $47.28\pm17.58$  \\
\hline
\end{tabular}

%\begin{tabular}{|l|ccc|ccc|}
\begin{tabular}{|l|C{1.2cm}C{1.2cm}C{2.1cm}|C{1.2cm}C{1.2cm}C{2.1cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\tfrac{S}{S+B}$ [\%] \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $140.4$ & $ 0.614$ & $-$ &  $89.0$ & $ 0.232$ & $-$  \\
 $\quad$ $1$-jet non-boosted &  $105.2$ & $ 0.397$ & $-$ &  $90.2$ & $ 0.196$ & $-$  \\
 $\quad$ $1$-jet boosted      &  $93.0$  & $ 0.174$ & $-$ &  $90.0$ & $ 0.153$ & $-$  \\
 $\quad$ $2$-jet VBF          &  $95.0$  & $ 0.661$ & $-$ &  $89.5$ & $ 0.155$ & $-$  \\
 SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $0$-jet              &  $161.2$ & $ 0.506$ & $0.36\pm0.01$  &  $110.4$ & $ 0.267$ & $0.34\pm0.01$  \\
 $\quad$ $1$-jet non-boosted &  $138.6$ & $ 0.363$ & $1.36\pm0.05$  &  $118.8$ & $ 0.211$ & $1.03\pm0.04$  \\
 $\quad$ $1$-jet boosted      &  $127.9$ & $ 0.201$ & $14.76\pm2.40$ &  $123.7$ & $ 0.122$ & $16.41\pm2.76$  \\
 SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & \\
 $\quad$ $2$-jet VBF          &  $129.6$ & $ 0.284$ & $36.44\pm13.38$ &  $122.6$ & $ 0.160$ & $46.34\pm17.59$  \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (S) and $\PZ/\Pggx \to \Pgt\Pgt$ background (B) and events 
  selected in different event categories in the $\Pe\Pgm$ decay channel.
  The improvement in signal-to-background separation is quantified also by the ratio $S/(S+B)$,
  computed within a mass window containing $68\%$ of signal events, as explained in the text.
}
\label{tab:resolutions_sm_emu}
\end{table}
%----------------------------------------------------------------------------------------------------

The choice of quantifying the resolution in terms of the ratio $\sigma/\textrm{M}$ is motivated 
by the fact that the distributions in $m_{\Pgt\Pgt}$, respectively in $m_{\vis}$, may be shifted with respect to $m_{\Pgt\Pgt}^{\true}$.
While the distributions in $m_{\Pgt\Pgt}$ reconstructed by the different versions of the SVfit algorithm,
as well as by the CA method, peak close to $m_{\Pgt\Pgt}^{\true}$,
the distributions in $m_{\vis}$ exhibit significant shifts towards lower mass.
The shift of the $m_{\vis}$ distribution is in general highest for events in the $\Pe\Pgm$ decay channel and lowest for events in the $\tauh\tauh$ decay channel,
reflecting the fact that the visible $\Pgt$ decay products typically carry a lower fraction of $\Pgt$ lepton energy in leptonic compared to hadronic $\Pgt$ decays.
The shift is more pronounced in events selected in the $1$-jet and $2$-jet VBF categories and less pronounced in the $0$-jet category.
In particular in the $\tauh\tauh$ channel,
the $\pT$ cuts that are applied on the $\tauh$ remove most of the $\PZ/\Pggx \to \Pgt\Pgt$ events in the $0$-jet category,
except for a few events with large $m_{\vis}$.
The events selected in the $1$-jet and $2$-jet VBF categories typically have smaller $m_{\vis}$, as $m_{\vis}$ decreases proportional to the cosine of the angle between the $\Pgt$ leptons,
$m_{\vis} \approx \pT^{\vis(1)} \, \cosh\eta_{\vis(1)} \cdot \pT^{\vis(2)} \, \cosh\eta_{\vis(2)} \cdot \left( 1 - \cos\sphericalangle(\Pgt,\Pgt) \right)$.
All algorithms can be trivially calibrated such that the median of each mass distribution coincides with the true mass of the $\Pgt$ lepton pair,
by scaling the output of the algorithm by a suitably chosen constant.
The advantage of quantifying the resolution in terms of the ratio $\sigma/\textrm{M}$ is that the ratio
is invariant under such scaling.

The ratio of the SM $\PHiggs \to \Pgt\Pgt$ signal to the $\PZ/\Pggx \to \Pgt\Pgt$ background in general increases with jet multiplicity.
The ratio is more favourable in the $1$-jet boosted compared to the $1$-jet non-boosted category.
The categories with the highest signal-to-background ratio, the $1$-jet boosted and the $2$-jet VBF category,
in fact provide most of the sensitivity of the SM $\PHiggs \to \Pgt\Pgt$ analysis.
Due to the correlation of between jet multiplicity, the $\pT$ of the $\PHiggs$ respectively $\PZ$ boson, and $\Delta\phi_{\Pgt\Pgt}$,
visualized in Fig.~\ref{fig:ditau_pT_and_dphi}, the improvement in mass resolution provided by the SVfit algorithm is largest in these categories,
enhancing the separation of the SM $\PHiggs \to \Pgt\Pgt$ signal from the $\PZ/\Pggx \to \Pgt\Pgt$ background where it matters most.
In the SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$,
the use of $m_{\Pgt\Pgt}$ reconstructed by the SVfit algorithm for the signal extraction has increased the expected significance for observing a signal by $\approx 40\%$ compared to $m_{\vis}$~\cite{HIG-13-004}.

The reconstruction of $m_{\Pgt\Pgt}$ by the CA method performs suboptimal compared to SVfit.
In particular the pronounced high mass tails in the $m_{\Pgt\Pgt}$ distribution, arising from resolution effects,
significantly reduce the sensitivity for observing a signal,
as they cause a sizeable fraction of $\PZ/\Pggx \to \Pgt\Pgt$ background events
to be reconstructed near the signal region $m_{\Pgt\Pgt} \approx 125$~\GeV.
A further disadvantage of the CA method is that it fails to yield a physical solution for approximately half of the events,
whereas the SVfit algorithm provides a physical solution for every event. 

The performance of the cSVfit algorithm to reconstruct the $\pT$,
$\eta$, and $\phi$ of the $\Pgt$ lepton pair is studied in SM $\PHiggs
\to \Pgt\Pgt$ signal events produced via the gluon fusion process
and in $\PZ/\Pggx \to \Pgt\Pgt$ background events,
separately for the decay channels $\tauh\tauh$, $\Pgm\tauh$, and $\Pe\Pgm$.
Distributions of the difference between reconstructed and true $\pT$,
$\eta$, and $\phi$ of the $\PHiggs$ boson are shown in
Fig.~\ref{fig:resolutions_sm_pT_eta_and_phi}.
Compared to the case that the $\PHiggs$ boson $\pT$ and $\phi$ are
reconstructed by computing the sum of the momenta of the visible $\Pgt$
decay products and $\MET$, the cSVfit algorithm improves the
resolution by $10$--$20\%$. The pseudo-rapidity $\eta$ of the
$\PHiggs$ boson can only be reconstructed with the cSVfit algorithm.
Typical resolutions on the $\pT$, $\eta$, and $\phi$ of the $\PHiggs$ boson,
reconstructed by the cSVfit algorithm, amount to $10$~\GeV, $0.4$~\rad, and $0.8$~\rad,
respectively.

%----------------------------------------------------------------------------------------------------
%
% resolution in ditau pT, eta, and phi reconstructed by the cSVfit algorithm in SM Higgs->tautau signal events,
% compared to reconstructing the Higgs boson pT and phi by computing the sum of momenta of the visible tau decay products and MET
%

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
%=======
\begin{picture}(180,210)(0,0)
\put(-2.5, -2.0){\mbox{\includegraphics*[height=214mm]
{plots_sept_16/Higgs_resolutions_pT.pdf}}}
\put(50.5, -2.0){\mbox{\includegraphics*[height=214mm]
{plots_sept_16/Higgs_resolutions_eta.pdf}}}
\put(103.5, -2.0){\mbox{\includegraphics*[height=214mm]
{plots_sept_16/Higgs_resolutions_phi.pdf}}}
\end{picture}
\end{center}
\caption{
  Resolution on $\pT$ (a,d,g), $\eta$ (b,e,h), and $\phi$ (c,f,i) of the $\Pgt$ lepton
  pair in SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to
  \Pgt\Pgt$ background events,
  separately for the decay channels $\tauh\tauh$ (a,b,c), $\Pgm\tauh$ (d,e,f),
  and $\Pe\Pgm$ (g,h,i).
  The SM $\PHiggs \to \Pgt\Pgt$ signal events are produced via the
  gluon fusion process.
  The resolutions on $\pT$ and $\phi$ achieved by computing the sum of
  the momenta of the visible $\Pgt$ decay products and $\MET$ are shown for comparison.
}
\label{fig:resolutions_sm_pT_eta_and_phi}
\end{figure}
%----------------------------------------------------------------------------------------------------

Distributions in $m_{\Pgt\Pgt}$ reconstructed by different versions of
the SVfit algorithm, by the CA method, and of $m_{\vis}$ in heavy
pseudoscalar Higgs boson signal and $\PZ/\Pggx \to \Pgt\Pgt$
background events are shown in
Figs.~\ref{fig:massDistributions_mssm_tautau}
to~\ref{fig:massDistributions_mssm_emu}.
The distributions in $m_{\Pgt\Pgt}$ reconstructed by the cSVfit and
SVfitMEM algorithms are shown with and without the artificial regularization
term described in Section~\ref{sec:mem_logM}. 
The reduction of high mass tails in the $m_{\Pgt\Pgt}$ distribution
for the irreducible $\PZ/\Pggx \to \Pgt\Pgt$
background is important no only in the context of the SM $\PHiggs \to
\Pgt\Pgt$ analysis, but also for searches for heavy resonances, as the signal cross section is expected to fall steeply as function of resonance mass,
such that potential high mass signals would likely be buried underneath the high mass tail of the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background otherwise.
The axis of abscissae and the ordinate are drawn in logarithmic scale to better visualize differences in the high mass tails.

%----------------------------------------------------------------------------------------------------
%
% mTauTau distributions in MSSM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
\put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu200_hadhad_log_ratio.pdf}}}
\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu300_hadhad_log_ratio.pdf}}}
\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu500_hadhad_log_ratio.pdf}}}
\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu800_hadhad_log_ratio.pdf}}}
\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu1200_hadhad_log_ratio.pdf}}}
\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_legend_hadhad.pdf}}}
\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\end{picture}
\end{center}
\caption{
  Distributions in alternative mass observables in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), and $1200$~\GeV (e).
  The events are selected in the $\tauh\tauh$ decay channel.
  The axis of abscissae ranges from $0.1$ to $8$.
}
\label{fig:massDistributions_mssm_tautau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
\put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu200_muhad_log_ratio.pdf}}}
\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu300_muhad_log_ratio.pdf}}}
\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu500_muhad_log_ratio.pdf}}}
\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu800_muhad_log_ratio.pdf}}}
\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu1200_muhad_log_ratio.pdf}}}
\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_legend_muhad.pdf}}}
\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\end{picture}
\end{center}
\caption{
  Distributions in alternative mass observables in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), and $1200$~\GeV (e).
  The events are selected in the $\Pgm\tauh$ decay channel.
  The axis of abscissae ranges from $0.1$ to $8$.
}
\label{fig:massDistributions_mssm_mutau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
  \put(-2.5, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu200_emu_log_ratio.pdf}}}
\put(79.0, 152.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu300_emu_log_ratio.pdf}}}
\put(-2.5, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu500_emu_log_ratio.pdf}}}
\put(79.0, 77.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu800_emu_log_ratio.pdf}}}
\put(-2.5, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu1200_emu_log_ratio.pdf}}}
\put(79.0, 2.0){\mbox{\includegraphics*[height=64mm]
  {plots_sept_16/makeSVfitMEM_PerformancePlots_legend_emu.pdf}}}

\put(35.5, 150.0){\small (a)}
\put(117.0, 150.0){\small (b)}
\put(35.5, 75.0){\small (c)}
\put(117.0, 75.0){\small (d)}
\put(35.5, 0.0){\small (e)}
\end{picture}
\end{center}
\caption{
  Distributions in alternative mass observables in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), and $1200$~\GeV (e).
  The events are selected in the $\Pe\Pgm$ decay channel.
  The axis of abscissae ranges from $0.1$ to $8$.
}
\label{fig:massDistributions_mssm_emu}
\end{figure}
%----------------------------------------------------------------------------------------------------

The SVfit algorithm significantly improves the separation of the
heavy Higgs boson signal from the irreducible $\PZ/\Pggx \to \Pgt\Pgt$
background in all three decay channels.
Numerical values for the median $\textrm{M}$ and for the ratio $\sigma/\textrm{M}$ of the
distribution, are given in Tables~\ref{tab:resolutions_mssm_tautau}
to~\ref{tab:resolutions_mssm_emu}.
The tables also give the median $\textrm{M}$ and ratio $\sigma/\textrm{M}$
for a heavy spin $1$ resonance.

%----------------------------------------------------------------------------------------------------
%
% mass resolutions in MSSM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{table}
\begin{center}
\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{$m_{\vis}$} & \multicolumn{2}{c|}{SVfitSA} \\
\cline{2-5}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $146.5$  & $ 0.174$ &  $189.0$ & $ 0.139$   \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $199.4$  & $ 0.223$ &  $273.4$ & $ 0.169$   \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $310.1$  & $ 0.267$ &  $445.0$ & $ 0.194$   \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $473.2$  & $ 0.298$ &  $713.1$ & $ 0.199$   \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $700.0$  & $ 0.310$ &  $1065.4$ & $ 0.201$  \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $1030.9$ & $ 0.322$ &  $1604.0$ & $ 0.202$  \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $1475.2$ & $ 0.331$ &  $2311.8$ & $ 0.203$  \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $1369.4$ & $ 0.379$ &  $2060.6$ & $ 0.286$  \\
\hline
\end{tabular}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{cSVfit, $\kappa=0$} & \multicolumn{2}{c|}{cSVfit, $\kappa=5$} \\
\cline{2-5}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $204.9$  & $ 0.263$ &  $186.7$ & $ 0.137$   \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $299.7$  & $ 0.268$ &  $271.1$ & $ 0.167$   \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $488.5$  & $ 0.255$ &  $443.3$ & $ 0.189$   \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $773.1$  & $ 0.223$ &  $712.7$ & $ 0.193$   \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $1151.7$ & $ 0.222$ &  $1066.6$ & $ 0.195$  \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $1717.6$ & $ 0.215$ &  $1601.8$ & $ 0.197$  \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $2471.2$ & $ 0.205$ &  $2312.3$ & $ 0.199$  \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $2322.4$ & $ 0.300$ &  $2084.1$ & $ 0.278$ \\ 
\hline
\end{tabular}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{2}{c|}{SVfitMEM, $\kappa=5$} \\
\cline{2-5}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $202.0$ & $ 1.455$  &  $186.1$  & $ 0.137$     \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $294.9$ & $ 1.126$  &  $269.0$  & $ 0.168$     \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $486.4$ & $ 1.595$  &  $440.7$  & $ 0.191$    \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $775.3$ & $ 1.426$  &  $704.6$  & $ 0.194$    \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $1139.6$ & $ 0.717$ &  $1054.6$ & $ 0.196$  \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $1628.2$ & $ 0.207$ &  $1557.8$ & $ 0.194$  \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $2293.7$ & $ 0.186$ &  $2216.7$ & $ 0.201$  \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $2081.5$ & $ 0.265$ & $1991.8$ & $ 0.277$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm,
  in simulated signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$
  and in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events.
  The events are selected in the $\tauh\tauh$ decay channel.
}
\label{tab:resolutions_mssm_tautau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{$m_{\vis}$} & \multicolumn{2}{c|}{SVfitSA} \\
\cline{2-5}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$  \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $110.9$  & $ 0.263$ &  $184.5$  & $ 0.190$   \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $150.8$  & $ 0.313$ &  $271.1$  & $ 0.213$   \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $229.9$  & $ 0.367$ &  $448.1$  & $ 0.232$   \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $348.9$  & $ 0.404$ &  $719.2$  & $ 0.228$   \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $508.9$  & $ 0.429$ &  $1084.6$ & $ 0.228$   \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $741.6$  & $ 0.452$ &  $1630.3$ & $ 0.225$   \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $1056.9$ & $ 0.461$ &  $2357.0$ & $ 0.223$   \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $973.0$ &  $ 0.496$ & $2055.3$ & $ 0.316$ \\
\hline
\end{tabular}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{cSVfit, $\kappa=0$} & \multicolumn{2}{c|}{cSVfit, $\kappa=4$} \\
\cline{2-5}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $212.2$  & $ 0.556$ &  $184.2$  & $ 0.187$   \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $309.4$  & $ 0.467$ &  $271.1$  & $ 0.208$   \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $502.3$  & $ 0.437$ &  $449.7$  & $ 0.223$   \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $795.1$  & $ 0.358$ &  $718.3$  & $ 0.221$   \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $1180.7$ & $ 0.289$ &  $1083.7$ & $ 0.222$   \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $1759.0$ & $ 0.258$ &  $1630.7$ & $ 0.220$   \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $2526.1$ & $ 0.230$ &  $2359.1$ & $ 0.220$   \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $2426.3$ & $ 0.341$ &  $2078.5$ & $ 0.310$   \\
\hline
\end{tabular}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{2}{c|}{SVfitMEM, $\kappa=4$} \\
\cline{2-5}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $205.8$  & $ 0.291$ &  $183.1$  & $ 0.185$  \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $303.0$  & $ 0.282$ &  $268.8$  & $ 0.209$  \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $496.3$  & $ 0.283$ &  $446.4$  & $ 0.226$  \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $778.2$  & $ 0.394$ &  $709.2$  & $ 0.224$  \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $1152.5$ & $ 0.295$ &  $1072.7$ & $ 0.223$  \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $1646.7$ & $ 0.183$ &  $1569.5$ & $ 0.218$  \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $2314.6$ & $ 0.193$ &  $2226.2$ & $ 0.223$  \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $2025.8$ & $ 0.275$ &  $1918.0$ & $ 0.307$  \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm,
  in simulated signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$
  and in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events.
  The events are selected in the $\Pgm\tauh$ decay channel.
}
\label{tab:resolutions_mssm_mutau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{$m_{\vis}$} & \multicolumn{2}{c|}{SVfitSA} \\
\cline{2-5}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $75.9$  & $ 0.367$  &  $177.6$  & $ 0.259$   \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $101.9$ & $ 0.434$  &  $265.2$  & $ 0.282$   \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $157.1$ & $ 0.487$  &  $451.2$  & $ 0.271$   \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $237.6$ & $ 0.525$  &  $720.6$  & $ 0.281$   \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $340.8$ & $ 0.567$  &  $1087.0$ & $ 0.277$   \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $515.9$ & $ 0.568$  &  $1655.3$ & $ 0.263$   \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $703.4$ & $ 0.610$  &  $2370.6$ & $ 0.268$   \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $652.3$ & $ 0.656$  &  $1991.1$ & $ 0.384$   \\
\hline
\end{tabular}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{cSVfit, $\kappa=0$} & \multicolumn{2}{c|}{cSVfit, $\kappa=3$} \\
\cline{2-5}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
$\quad m_{\PHiggsps} = 200$~\GeV   &  $220.8$  & $ 1.195$ &  $182.8$  & $ 0.257$   \\
$\quad m_{\PHiggsps} = 300$~\GeV   &  $317.3$  & $ 1.068$ &  $272.1$  & $ 0.276$   \\
$\quad m_{\PHiggsps} = 500$~\GeV   &  $510.8$  & $ 0.792$ &  $456.9$  & $ 0.264$   \\
$\quad m_{\PHiggsps} = 800$~\GeV   &  $805.3$  & $ 0.575$ &  $729.8$  & $ 0.281$   \\
$\quad m_{\PHiggsps} = 1200$~\GeV  &  $1196.5$ & $ 0.461$ &  $1099.4$ & $ 0.274$   \\
$\quad m_{\PHiggsps} = 1800$~\GeV  &  $1774.6$ & $ 0.317$ &  $1667.0$ & $ 0.259$   \\
$\quad m_{\PHiggsps} = 2600$~\GeV  &  $2534.6$ & $ 0.261$ &  $2402.8$ & $ 0.263$   \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
$\quad m_{\PZ'} = 2500$~\GeV       &  $2438.9$ & $ 0.403$ &  $2077.2$ & $ 0.386$  \\
\hline
\end{tabular}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{2}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{2}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-5}
& $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & \\
 $\quad m_{\PHiggsps} = 200$~\GeV   &  $211.8$  & $ 0.491$ &  $179.6$  &  $0.256$   \\
 $\quad m_{\PHiggsps} = 300$~\GeV   &  $312.9$  & $ 0.358$ &  $267.6$  &  $0.279$   \\
 $\quad m_{\PHiggsps} = 500$~\GeV   &  $510.4$  & $0.282$  &  $456.8$  &  $0.264$   \\
 $\quad m_{\PHiggsps} = 800$~\GeV   &  $793.2$  & $0.238$  &  $719.7$  &  $0.269$   \\
 $\quad m_{\PHiggsps} = 1200$~\GeV  &  $1177.5$ & $0.193$  &  $1087.5$ &  $0.257$  \\
 $\quad m_{\PHiggsps} = 1800$~\GeV  &  $1664.1$ & $0.178$  &  $1586.5$ &  $0.242$  \\
 $\quad m_{\PHiggsps} = 2600$~\GeV  &  $2306.3$ & $0.211$  &  $2204.1$ &  $0.261$  \\
$\PZ' \to \Pgt\Pgt$: & & & &  \\
 $\quad m_{\PZ'} = 2500$~\GeV       &  $1901.3$ & $0.306$  &  $1743.3$ &  $0.373$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolution $\sigma/\textrm{M}$ 
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm,
  in simulated signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$
  and in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events.
  The events are selected in the $\Pe\Pgm$ decay channel.
}
\label{tab:resolutions_mssm_emu}
\end{table}
%----------------------------------------------------------------------------------------------------

We interpret the fact that the performance of the SVfitMEM and cSVfit algorithms is very similar for an $\PHiggsps \to \Pgt\Pgt$ signal of mass $2600$~\GeV
and for a $\PZ' \to \Pgt\Pgt$ signal of mass $2500$~\GeV as evidence that the choice of using
the LO ME for the gluon fusion process $\Pg\Pg \to \PHiggs$ in the SVfitMEM algorithm represents no limitation for using
the SVfitMEM algorithm in data analyses of $\Pgt$ lepton pair production other than studies of Higgs boson production.

The improvement in signal and background separation provided by the
SVfit algorithm is illustrated in Fig.~\ref{fig:distributions_mVis_vs_SVfit}.

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,214)(0,0)
\put(-2.5, 150.0){\mbox{\includegraphics*[height=70mm]
  {plots_sept_16/svFitPerformance_hadhad_visMass.pdf}}}
\put(80.0, 150.0){\mbox{\includegraphics*[height=70mm]
  {plots_sept_16/svFitPerformance_hadhad_svFitMass.pdf}}}
\put(-2.5, 75.0){\mbox{\includegraphics*[height=70mm]
  {plots_sept_16/svFitPerformance_muhad_visMass.pdf}}}
\put(80.0, 75.0){\mbox{\includegraphics*[height=70mm]
  {plots_sept_16/svFitPerformance_muhad_svFitMass.pdf}}}
\put(-2.5, 0.0){\mbox{\includegraphics*[height=70mm]
  {plots_sept_16/svFitPerformance_emu_visMass.pdf}}}
\put(80.0, 0.0){\mbox{\includegraphics*[height=70mm]
  {plots_sept_16/svFitPerformance_emu_svFitMass.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\vis}$ (left) and in $m_{\Pgt\Pgt}$ reconstructed by the SVfitMEM algorithm with small positive $\kappa$ (right)
  in simulated $\PZ \to \Pgt\Pgt$ background events and $\PHiggs \to \Pgt\Pgt$ signal events,
  selected in the decay channels $\tauh\tauh$ ($\kappa = 5$, top), $\Pgm\tauh$ ($\kappa = 4$, centre), and $\Pe\Pgm$ ($\kappa = 3$, bottom).
  The signal events are generated for $\PHiggs$ boson masses of $m_{\PHiggs} = 125$, $200$, and $300$~\GeV. 
}
\label{fig:distributions_mVis_vs_SVfit}
\end{figure}

We conclude the discussion of the performance of the SVfit algorithm
with a comparison of the computing time requirements of the SVfitMEM,
cSVfit, and SVfitSA algorithms.
The computing time is dominated by the
evaluation of the integrand during the numeric integration.
The requirement on the computing time is expected to be
highest for the SVfitMEM algorithm, arising from the additional evaluation of the PDF and of the TF in Eq.~(\ref{eq:mem_with_hadRecoil}).
The time for reconstructing $m_{\Pgt\Pgt}$ in a single event scales approximately linearly
with the number of evaluations of the integrand.
The SVfitMEM (SVfitSA) algorithm performs $20,000$ ($10,000$)
evaluations of the integrand per mass hypothesis
$m_{\PHiggs}^{\textrm{test}(i)}$.
The number of evaluations of the integrand per mass hypothesis $m_{\PHiggs}^{\textrm{test}(i)}$ is chosen such that the
resolution on $m_{\Pgt\Pgt}$ is within $1\%$ compared to the resolution obtained in case an infinite (very large) number of evaluations of the
integrand is performed.
The number of mass hypotheses tested for an event varies depending on the
conditions described in Section~\ref{sec:mem_numericalMaximization}.
For the series of mass hypotheses defined by Eq.~(\ref{eq:mTauTau_step_size}), the number of test mass
hypotheses increases approximately logarithmically with the
true mass of the $\Pgt$ lepton pair. 
For signal events the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$
is typically computed for a series of $20$--$30$ mass hypotheses $m_{\PHiggs}^{\textrm{test}(i)}$.
The average length of the series of test mass hypothesis varies with the decay channel.
The series is typically the longest in the $\Pe\Pgm$ channel and the shortest in the $\tauh\tauh$,
as the value of $m_{\vis}$ that is used to initialize the series is farther away respectively less far away from the true mass of the $\Pgt$ lepton pair,
where the probability density $\mathcal{P}^{\textrm{max}}$ is expected to reach its maximum.
Background events may require to compute $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$ for a larger number of test mass hypotheses,
as the probability density may be almost degenerate over a large range in $m_{\PHiggs}^{\textrm{test}(i)}$.
The number of evaluations of the integrand is higher for the SVfitMEM
compared to the SVfitSA algorithm, accounting for the fact that the additional PDF and TF factors
raise the variation of the integrand,
which requires a higher numerical precision of the integration in
order to reliably determine the maximum $\mathcal{P}^{\textrm{max}}$ of the probability density.
The numeric integration is performed by the VAMP algorithm in case of
the SVfitMEM algorithm (\cf Section~\ref{sec:mem_numericalMaximization}) and by the VEGAS algorithm
in case of the SVfitSA algorithm.
In case of the cSVfit algorithm, the numeric integration is performed
by a custom implementation of the Markov chain Monte Carlo method, as described in Section~\ref{sec:classicSVfit}.
In the latter case, the integrand is evaluated $100,000$ times per event and there is no
iteration over a sequence of mass hypotheses.
The computing time is measured by CPU time, 
using a single core of a $2.30$~GHz Intel\TReg~Xeon\TReg~E$5$-$2695$ v$3$ processor.
The distribution of the computing time, in units of seconds per event, 
spent to compute $m_{\Pgt\Pgt}$
in SM SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to \Pgt\Pgt$ background events
using the SVfitMEM, cSVfit and SVfitSA algorithms is shown in
Fig.~\ref{fig:computing_time}.
Numerical values of the mean and RMS of the CPU time distributions are given in Table~\ref{tab:computing_time}.
The cSVfit algorithm requires about $0.5$~s of CPU time per event.
Within this time, the mass $m_{\Pgt\Pgt}$ of the $\Pgt$ lepton pair,
as well as its $\pT$, $\eta$, $\phi$, and transverse mass
$m_{T\Pgt\Pgt}$ are reconstructed.
Compared to the SVfitSA algorithm, the cSVfit algorithm reduces the
computing time by a significant factor. 
The reduction in computing time is
due to the more efficient Markov chain Monte
Carlo integration method, compared to
computing the probability density
$\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$
for a series of mass hypotheses.
The double-peak structure in the CPU time distribution of the SVfitSA algorithm is due to events in which the numerical uncertainty on the integral of the likelihood function, 
as estimated by VEGAS, exceeds a certain precision target.
In this case, another $10,000$ evaluations of the integrand are performed by the SVfitSA algorithm, up to a total of $50,000$ evaluations of the integrand per test mass hypothesis.
Compared to the cSVfit algorithm, the computing time requirement of the SVfitMEM algorithm is higher
by about one order of magnitude. 

%----------------------------------------------------------------------------------------------------
%
% computing time requirements of the SVfitMEM, cSVfit, and SVfitSA in SM Higgs->tautau signal and Z/gamma*->tautau background events 
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,210)(0,0)
\put(-2.5, -4.0){\mbox{\includegraphics*[height=214mm]
{plots_sept_16/Higgs_DYJets_CPU_time.pdf}}}
\end{picture}
\end{center}
\caption{
  CPU time per event required for reconstruction of $m_{\Pgt\Pgt}$ by
  the SVfitMEM, cSVfit, and SVfitSA algorithms
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (a,c,e)
  and $\PZ/\Pggx \to \Pgt\Pgt$ background (b,d,f) events
  in the decay channels $\tauh\tauh$ (a,b), $\Pgm\tauh$ (c,d),
  and $\Pe\Pgm$ (e,f).
}
\label{fig:computing_time}
\end{figure}

\begin{table}
\begin{center}
\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{24mm}{Algorithm} & \multicolumn{2}{c|}{$\PZ/\Pggx \to \Pgt\Pgt$} & \multicolumn{2}{c|}{SM $\PHiggs \to \Pgt\Pgt$} \\
\cline{2-5}
& Mean~[s] & RMS~[s] & Mean~[s] & RMS~[s] \\
\hline
SVfitSA & $3.51$ & $5.24$ & $3.75$ & $5.87$ \\
cSVfit & & & & \\
$\quad \kappa=0$ & $0.72$ & $0.17$ & $0.73$ & $0.18$ \\
$\quad \kappa=5$ & $0.77$ & $0.20$ & $0.78$ & $0.20$ \\
SVfitMEM & & & & \\
$\quad \kappa=0$ & $13.07$ & $6.27$ & $14.03$ & $6.89$ \\
$\quad \kappa=5$ & $10.72$ & $4.72$ & $11.44$ & $5.02$ \\
\hline
\end{tabular}

\vspace{3.5mm}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{24mm}{Algorithm} & \multicolumn{2}{c|}{$\PZ/\Pggx \to \Pgt\Pgt$} & \multicolumn{2}{c|}{SM $\PHiggs \to \Pgt\Pgt$} \\
\cline{2-5}
& Mean~[s\unskip] & RMS~[s\unskip] & Mean~[s\unskip] & RMS~[s\unskip] \\
\hline
SVfitSA & $5.82$ & $9.22$ & $5.02$ & $7.91$ \\
cSVfit & & & & \\
$\quad \kappa=0$ & $0.62$ & $0.11$ & $0.56$ & $0.12$ \\
$\quad \kappa=4$ & $0.73$ & $0.17$ & $0.61$ & $0.16$ \\
SVfitMEM & & & & \\
$\quad \kappa=0$ & $22.64$ & $12.99$ & $18.45$ & $10.15$ \\
$\quad \kappa=4$ & $18.38$ & $7.49$ & $15.83$ & $6.68$ \\
\hline
\end{tabular}

\vspace{3.5mm}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{24mm}{Algorithm} & \multicolumn{2}{c|}{$\PZ/\Pggx \to \Pgt\Pgt$} & \multicolumn{2}{c|}{SM $\PHiggs \to \Pgt\Pgt$} \\
\cline{2-5}
& Mean~[s\unskip] & RMS~[s\unskip] & Mean~[s\unskip] & RMS~[s\unskip] \\
\hline
SVfitSA & $10.26$ & $14.65$ & $7.68$ & $10.35$ \\
cSVfit & & & & \\
$\quad \kappa=0$ & $0.34$ & $0.06$ & $0.34$ & $0.06$ \\
$\quad \kappa=3$ & $0.39$ & $0.08$ & $0.37$ & $0.09$ \\
SVfitMEM & & & & \\
$\quad \kappa=0$ & $30.92$ & $16.59$ & $19.37$ & $12.29$ \\
$\quad \kappa=3$ & $22.56$ & $7.70$ & $16.62$ & $7.43$ \\
\hline
\end{tabular}
\end{center}
\caption{
  CPU time per event required for reconstruction of $m_{\Pgt\Pgt}$ by
  the SVfitMEM, cSVfit, and SVfitSA algorithms
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal 
  and $\PZ/\Pggx \to \Pgt\Pgt$ background events
  in the decay channels $\tauh\tauh$, $\Pgm\tauh$,
  and $\Pe\Pgm$.
}
\label{tab:computing_time}
\end{table}
%----------------------------------------------------------------------------------------------------

Considering that the resolution on $m_{\Pgt\Pgt}$,
quantified by the ratio $\sigma/\textrm{M}$, achieved
by the SVfitMEM and cSVfit algorithms is almost identical, we find that the cSVfit
algorithm represents the best compromise between physics performance and computing time requirements.
The optimal resolution on $m_{\Pgt\Pgt}$, quantified by the ratio $\sigma/\textrm{M}$,
is achieved in case an artificial regularization term of the type described in Section~\ref{sec:mem_logM}, with small positive $\kappa$,
is added to the likelihood function.
We expect the optimal choice of $\kappa$ to depend on the rates of signal and background processes as well as on the experimental resolution,
and we recommend to perform a reoptimization of $\kappa$ in practical applications of our algorithm.

The merit of the SVfitMEM algorithm is that the 
formalism to treat $\Pgt$ lepton decays in the ME method, developed
for the SVfitMEM algorithm, can be used
in future applications of the ME method to data analyses with $\Pgt$
leptons in the final state.
