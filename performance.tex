\section{Performance}
\label{sec:performance}

The performance of the $m_{\Pgt\Pgt}$ reconstruction is studied in simulated events.
Samples of SM $\PHiggs \to \Pgt\Pgt$ signal events
are generated with the next-to-leading-order (NLO) program POWHEG v2~\cite{POWHEG1,POWHEG2,POWHEG3}
for a $\PHiggs$ boson of mass $m_{\PHiggs} = 125$~\GeV 
and for the gluon fusion ($\Pg\Pg \to \PHiggs$) and vector boson fusion ($\Pquark\APquark \to \PHiggs$) production processes.
We also study the $m_{\Pgt\Pgt}$ reconstruction in events containing
heavy pseudoscalar Higgs bosons $\PHiggsps$ of mass $m_{\PHiggsps} = 200$, $300$, $500$, $800$, $1200$, $1800$, and $2600$~\GeV,
produced via gluon fusion, and in events containing heavy spin $1$
resonances, of mass $2500$~\GeV, that decay into $\Pgt$ pairs.
We denote the latter by the symbol $\PZ'$. 
The $\PHiggsps \to \Pgt\Pgt$ and $\PZ' \to \Pgt\Pgt$ signal samples are generated with the LO generator PYTHIA 8.2~\cite{pythia8}.
The $\PZ/\Pggx \to \Pgt\Pgt$ background sample is generated with the LO MadGraph program, in the version MadGraph\_aMCatNLO 2.2.2~\cite{MadGraph_aMCatNLO}.
The sample contains $\Pgt$ lepton pairs of true mass $m_{\Pgt\Pgt}^{\true} > 50$~\GeV.
Most of the $\Pgt$ lepton pairs have a mass near the $\PZ$ peak at $m_{\PZ} = 91.2$~GeV~\cite{PDG}, 
but the sample also contains events of significantly higher mass.
Drell--Yan events of mass $m_{\Pgt\Pgt}^{\true} < 50$~\GeV are not relevant for this study, 
because they do not pass the selection criteria on $\pT$ and $\eta$ that are applied on analysis level.
All events are generated for proton-proton collisions at $\sqrt{s} = 13$~\TeV centre-of-mass energy.
The samples produced by MadGraph and POWHEG are generated with the NNPDF3.0 set of parton distribution functions,
while the samples produced by PYTHIA use the NNPDF2.3LO set~\cite{NNPDF1,NNPDF2,NNPDF3}.
Parton shower and hadronization processes are modelled using the generator PYTHIA with the tune CUETP8M1~\cite{PYTHIA_CUETP8M1tune_CMS}.
The latter is based on the Monash tune~\cite{PYTHIA_MonashTune}.
The decays of $\Pgt$ leptons, including polarization effects, are modelled by PYTHIA.
The samples are normalized according to cross section for the purpose of comparing different mass reconstruction algorithms in terms of signal-to-background separation.
The cross section of the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background is computed at NNLO accuracy and amounts to $1.92 \times 10^{3}$~pb~\cite{FEWZ}.
The cross sections for the SM $\PHiggs \to \Pgt\Pgt$ signal have been computed as detailed in Ref.~\cite{Dittmaier:2011ti},
with the updates described in Ref.~\cite{Heinemeyer:2013tqa} included.
They amount to $43.9$~pb for the $\Pg\Pg \to \PHiggs$ and to $3.75$~pb for the $\Pquark\APquark \to \PHiggs$ production process.
The $\PHiggsps \to \Pgt\Pgt$ and $\PZ' \to \Pgt\Pgt$ samples 
are scaled to a product of cross section times branching fraction, for the decay into $\Pgt$ lepton pairs, of $1$~pb.

The experimental resolutions on the $\pT$ of $\tauh$ and on the $\pX^{\rec}$ and $\pY^{\rec}$ of the hadronic recoil 
are simulated by sampling from the TF described in
Sections~\ref{sec:mem_TF_tauToHadDecays}
and~\ref{sec:mem_TF_hadRecoil}.
The $\eta$, $\phi$, and $m_{\vis}$ of $\tauh$,
as well as the $\pT$, $\eta$, and $\phi$ of electrons and muons are assumed to be reconstructed perfectly.

Distributions in $m_{\Pgt\Pgt}$ are computed separately for events in which 
both $\Pgt$ leptons decay hadronically ($\tauh\tauh$), 
events in which one $\Pgt$ lepton decays hadronically and the other into a muon ($\Pgm\tauh$),
and events in which one $\Pgt$ lepton decays into a muon and the other into an electron ($\Pe\Pgm$).
The visible $\Pgt$ decay products are required to pass selection criteria on $\pT$ and $\eta$,
which are motivated by the SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$~\cite{HIG-13-004}.
Events in the $\tauh\tauh$ decay channel are required to contain
two $\tauh$ of $\pT > 45$~\GeV and $\vert\eta\vert < 2.1$.
Events in the $\Pgm\tauh$ channel
are required to contain a muon of $\pT > 20$~\GeV and $\vert\eta\vert < 2.1$ and a $\tauh$ of $\pT > 30$~\GeV and $\vert\eta\vert < 2.3$.
Events selected in the $\Pe\Pgm$ channel are required to contain a muon with $\vert\eta\vert < 2.1$ and an electron with $\vert\eta\vert < 2.4$.
The lepton of higher $\pT$ (either the electron or the muon) is required to satisfy the condition $\pT > 20$~\GeV,
while the lepton of lower $\pT$ is required to satisfy $\pT > 10$~\GeV.
Similar selection criteria on $\pT$ and $\eta$ of the visible $\Pgt$ decay products were applied in the $\PHiggs \to \Pgt\Pgt$
analyses performed by the ATLAS
collaboration during LHC Run $1$~\cite{ATLAS_HiggsTauTau_SM,ATLAS_HiggsTauTau_MSSM}.

The $m_{\Pgt\Pgt}$ reconstruction in SM $\PHiggs \to \Pgt\Pgt$ signal events is studied in event categories motivated by the
SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$~\cite{HIG-13-004}:
\begin{itemize}
\item $0$-jet: 
  Events containing no jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$.
\item $1$-jet non-boosted:
  Events containing one or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$
  in which the $\PHiggs$ (respectively $\PZ$) boson satisfies $\pT < 100$~\GeV.
  Events in the $1$-jet non-boosted category are required not to be selected in the $2$-jet VBF category.
\item $1$-jet boosted:
  Events containing one or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$
  in which the $\PHiggs$ (respectively $\PZ$) boson satisfies $\pT > 100$~\GeV.
  Events in the $1$-jet boosted category are required not to be selected in the $2$-jet VBF category.
\item $2$-jet VBF:
  Events containing two or more jets of $\pT > 30$~\GeV and $\lvert \eta \rvert < 4.5$,
  with at least one pair of jets satisfying $m_{jj} > 500$~\GeV and $\Delta\eta_{jj} > 3.5$.
\end{itemize}
The event categorization is based on generator level quantities.

The $m_{\Pgt\Pgt}$ distributions reconstructed by the SVfitMEM and cSVfit algorithms in these event categories 
in the $\tauh\tauh$, $\Pgm\tauh$, and $\Pe\Pgm$ decay channels are shown in Figs.~\ref{fig:massDistributions_sm_tautau} to~\ref{fig:massDistributions_sm_emu}.
They are compared to the distributions in $m_{\Pgt\Pgt}$  reconstructed by the previous version of the
SVfit algorithm, described in Ref.~\cite{SVfit}, to which we refer to as the SVfit ``standalone'' (SVfitSA) algorithm,
and by the ``collinear-approximation'' (CA) method~\cite{massRecoCollinearApprox}.
The SVfitMEM and cSVfit algorithms are run with and without the artificial regularization term described in Section~\ref{sec:mem_logM}.
The value of $\kappa$ used for each channel is chosen such that the optimal resolution on $m_{\Pgt\Pgt}$, 
quantified in terms of the ratio of the root-mean-square (RMS) to the median $\textrm{M}$ of the distribution,
is attained.
We find that the choice of $\kappa = 5$ for the $\tauh\tauh$ channel, $\kappa = 4$ for the $\Pgm\tauh$ channel,
and $\kappa = 3$ for the $\Pe\Pgm$ channel performs well for the SVfitMEM as well as for the cSVfit algorithm.

%----------------------------------------------------------------------------------------------------
%
% mTauTau distributions in SM Higgs->tautau signal and Z/gamma*->tautau background events
%

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,212)(0,0)
\put(-4.0, -4.0){\mbox{\includegraphics*[height=216mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_DYJets_HiggsSM_all_categories_hadhad_log_ratio.pdf}}}
\put(117.5, 145.5){\mbox{\includegraphics*[width=52mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_legend_hadhad.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method and different versions of the SVfit algorithm in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non-boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\tauh\tauh$ decay channel. 
  The axis of abscissae ranges from $0.4$ to $8$.
}
\label{fig:massDistributions_sm_tautau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,212)(0,0)
\put(-4.0, -4.0){\mbox{\includegraphics*[height=216mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_DYJets_HiggsSM_all_categories_muhad_log_ratio.pdf}}}
\put(117.5, 145.5){\mbox{\includegraphics*[width=52mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_legend_muhad.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method and different versions of the SVfit algorithm in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events (a,c,e,g)
 and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non-boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\Pgm\tauh$ decay channel. 
  The axis of abscissae ranges from $0.4$ to $8$.
}
\label{fig:massDistributions_sm_mutau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,212)(0,0)
\put(-4.0, -4.0){\mbox{\includegraphics*[height=216mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_DYJets_HiggsSM_all_categories_emu_log_ratio.pdf}}}
\put(117.5, 145.5){\mbox{\includegraphics*[width=52mm]
{plots_sept_16/makeSVfitMEM_PerformancePlots_legend_emu.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method and different versions of the SVfit algorithm in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events (a,c,e,g)
  and in SM $\PHiggs \to \Pgt\Pgt$ signal events produced via the $\Pg\Pg \to \PHiggs$ (b,d,f) and $\Pquark\APquark \to \PHiggs$ (h) production processes
  in different event categories: $0$-jet (a,b), $1$-jet non-boosted (c,d), $1$-jet boosted (e,f),
  and $2$-jet VBF (g,h).
  The events are selected in the $\Pe\Pgm$ decay channel.
  The axis of abscissae ranges from $0.4$ to $8$.
}
\label{fig:massDistributions_sm_emu}
\end{figure}
%----------------------------------------------------------------------------------------------------

The distributions in $m_{\Pgt\Pgt}$ reconstructed by the cSVfit and SVfitMEM algorithms with artificial regularization term
and by the SVfitSA algorithm are very similar.
The SVfitSA algorithm performs well without adding an artificial regularization term of the type described in Section~\ref{sec:mem_logM} to its likelihood function.
This is because the effect of the missing factor $\frac{1}{z^{2}}$ in the likelihood function used by the SVfitSA algorithm (\cf Section~\ref{sec:classicSVfit})
is equivalent to using an artificial regularization term with $\kappa = 4$.
Regardless of the choice of $\kappa$, the peaks of the $m_{\Pgt\Pgt}$ distributions reconstructed by the different versions of the SVfit algorithm are close to the true value of the mass of the $\Pgt$ lepton pair
in all event categories.
Adding an artificial regularization term has little effect on the peak of the $m_{\Pgt\Pgt}$ distribution.
The motivation for adding the artificial regularization term is to reduce the tail of the $m_{\Pgt\Pgt}$ distribution for the
$\PZ/\Pggx \to \Pgt\Pgt$ background in the mass range in which the signal is expected.

The effect of adding the artificial regularization term is largest for events reconstructed in the $0$-jet category.
Events in the $0$-jet category are the most difficult to reconstruct.
In events in which the $\PHiggs$ or $\PZ$ boson has low $\pT$
the $\Pgt$ leptons are typically ``back-to-back'' in the transverse plane ($\Delta\phi_{\Pgt\Pgt} \approx \pi$), 
with the effect that the neutrinos produced in the $\Pgt$ lepton decays are emitted in opposite hemispheres and their contribution to $\MET$ cancels.
The cancellation of neutrino momenta causes mass hypotheses of low $m_{\PHiggs}^{\textrm{test}(i)} \approx m_{\vis}$
and of high $m_{\PHiggs}^{\textrm{test}(i)} \gg m_{\vis}$
to be degenerate in terms of the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$,
computed according to Eq.~(\ref{eq:mem_with_hadRecoil}).
The best estimate for the mass of the $\Pgt$ lepton pair in a given event may fluctuate 
due to mismeasurements, within the experimental resolution, of the components $\pX^{\rec}$ and $\pY^{\rec}$ of the hadronic recoil or, to a lesser extent, of the $\pT$ of $\tauh$,
degrading the resolution on $m_{\Pgt\Pgt}$.

The resolution on $m_{\Pgt\Pgt}$ typically improves with the $\pT$ of the $\PHiggs$ respectively $\PZ$ boson.
In events selected in the $1$-jet and $2$-jet VBF categories,
in which the $\Pgt$ lepton pair typically recoils against high $\pT$ jets,
the angle $\Delta\phi_{\Pgt\Pgt}$ between the $\Pgt$ leptons decreases due to the Lorentz boost in direction of the $\PHiggs$ or $\PZ$ boson.
The momenta of the neutrinos produced in the $\Pgt$ lepton decays add constructively in this case,
with the effect that the mass of the $\Pgt$ lepton pair is constrained by the measured value of $\MET$.
The distribution in $\pT$ of the $\Pgt$ lepton pair and in the angle $\Delta\phi_{\Pgt\Pgt}$ is shown in Fig.~\ref{fig:ditau_pT_and_dphi}
for SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to \Pgt\Pgt$ background events.
The events are selected in the $\Pgm\tauh$ decay channel.
The distributions for events selected in the $\tauh\tauh$ and $\Pe\Pgm$ decay channels are similar.

%----------------------------------------------------------------------------------------------------
%
% distributions in pT and deltaPhi of ditau system for SM Higgs->tautau signal and Z/gamma*->tautau background events
% selected in different event categories
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
%\includegraphics*[height=70mm]{plots_oct_25/Higgs_pT_muhad.pdf}
%\includegraphics*[height=70mm]{plots_oct_25/Higgs_dPhiTauTau_muhad.pdf}\\
%\includegraphics*[height=70mm]{plots_oct_25/DYJets_pT_muhad.pdf}
%\includegraphics*[height=70mm]{plots_oct_25/DYJets_dPhiTauTau_muhad.pdf}
\begin{picture}(160,153.5)(0,0)
\put(-1.5, 81.5){\mbox{\includegraphics*[height=72mm]
  {plots_oct_25/Higgs_pT_muhad.pdf}}}
\put(80.0, 81.5){\mbox{\includegraphics*[height=72mm]
  {plots_oct_25/Higgs_dPhiTauTau_muhad.pdf}}}
\put(-1.5, 0.0){\mbox{\includegraphics*[height=72mm]
  {plots_oct_25/DYJets_pT_muhad.pdf}}}
\put(80.0, 0.0){\mbox{\includegraphics*[height=72mm]
  {plots_oct_25/DYJets_dPhiTauTau_muhad.pdf}}}
%\put(35.5, 75.0){\small (a)}
%\put(117.0, 75.0){\small (b)}
%\put(35.5, 0.0){\small (c)}
%\put(117.5, 0.0){\small (d)}
\end{picture}
\end{center}
\caption{
  Distributions in $\pT$ of the $\PHiggs$ respectively $\PZ$ boson (a,c) and in the
  angle $\Delta\phi_{\Pgt\Pgt}$ (b,d) for SM $\PHiggs \to \Pgt\Pgt$ signal (a,b)
  and $\PZ/\Pggx \to \Pgt\Pgt$ background (c,d) events,
  selected in the $\Pgm\tauh$ decay channel.
  The signal events shown in the $0$-jet, $1$-jet non-boosted and
  $1$-jet boosted categories (in the $2$-jet VBF category) are produced via the $\Pg\Pg \to \PHiggs$
  ($\Pquark\APquark \to \PHiggs$) production process.   
}
\label{fig:ditau_pT_and_dphi}
\end{figure}
%----------------------------------------------------------------------------------------------------

The variation of the resolution on $m_{\Pgt\Pgt}$ across event categories is most pronounced in the $\Pe\Pgm$ and least pronounced in the $\tauh\tauh$ decay channel.
This is because the fraction of $\Pgt$ lepton energy carried by the visible $\Pgt$ decay products is typically high for hadronic $\Pgt$ decays and typically low for leptonic $\Pgt$ decays,
\cf Fig.~\ref{fig:tauDecay_z}.
For events in the $\tauh\tauh$ decay channel the best estimate for the mass of the $\Pgt$ lepton pair is typically not much higher than $m_{\vis}$,
regardless of the angle $\Delta\phi_{\Pgt\Pgt}$ between the $\Pgt$ leptons,
as the energies of the neutrinos produced in hadronic $\Pgt$ decays are known to be most likely small.
For events in the $\Pe\Pgm$ decay channel on the other hand,
$\Pgt$ lepton decays with high energetic neutrinos are known to be likely,
provided they are compatible with the measured value of $\MET$,
causing mass hypotheses of low $m_{\PHiggs}^{\textrm{test}(i)} \approx m_{\vis}$, corresponding to the case $z^{(1)} \approx 1$ and $z^{(2)} \approx 1$,
and of high $m_{\PHiggs}^{\textrm{test}(i)} \gg m_{\vis}$, corresponding to the case $z^{(1)} \ll 1$ and $z^{(2)} \ll 1$,
to be often degenerate in terms of the probability density $\mathcal{P}(\bm{p}^{\vis(1)},\bm{p}^{\vis(2)};\pX^{\rec},\pY^{\rec}|m_{\PHiggs}^{\textrm{test}(i)})$.

Numerical values for the resolution in $m_{\Pgt\Pgt}$ achieved by the different algorithms are given in Tables~\ref{tab:resolutions_sm_tautau} to~\ref{tab:resolutions_sm_emu}.
The mass of the visible $\Pgt$ decay products, $m_{\vis}$, is given in the tables for comparison.
The resolution is quantified separately for the low mass and for the high mass tail of the mass distribution reconstructed by a given algorithm.
The symbol $\sigma_{l}/\textrm{M}$ ($\sigma_{h}/\textrm{M}$) denotes the 
ratio of the difference between the median and the $16\%$ quantile (between $84\%$ quantile and the median) to the median
of the mass distribution.
The capability of each algorithm to separate the SM $\PHiggs \to \Pgt\Pgt$ signal from the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background 
is quantified in terms of $\textrm{S}/(\textrm{S} + \textrm{B})$, the ratio of the number of SM $\PHiggs \to \Pgt\Pgt$ signal events to the sum of signal plus $\PZ/\Pggx \to \Pgt\Pgt$ background events.
The yields $\textrm{S}$ of signal and $\textrm{B}$ of background events are computed within a mass window containing $68\%$ of signal events,
with $16\%$ of signal events on either side of the mass window, and for SM signal and background cross sections.

%----------------------------------------------------------------------------------------------------
%
% mass resolutions in SM Higgs->tautau signal and Z/gamma*->tautau background events,
% in event categories motivated by Run 1 SM Higgs->tautau analysis
%
\begin{table}
\begin{center}
\begin{tabular}{|l|cccc|cccc|}
\hline
\multicolumn{9}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{$m_{\vis}$} & \multicolumn{4}{c|}{SVfitSA} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $100.0$ & $0.072$ & $0.101$ & $-$ & $117.9$ & $0.078$ & $0.090$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $86.3$ & $0.107$ & $0.140$ & $-$ & $101.6$ & $0.100$ & $0.148$ & $-$ \\
 $\quad$ $1$-jet boosted & $70.1$ & $0.195$ & $0.170$ & $-$ & $90.4$ & $0.092$ & $0.100$ & $-$ \\
 $\quad$ $2$-jet VBF & $66.7$ & $0.190$ & $0.230$ & $-$ & $90.7$ & $0.090$ & $0.080$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $109.2$ & $0.080$ & $0.088$ & $0.144$ & $130.0$ & $0.079$ & $0.095$ & $0.161$ \\
 $\quad$ $1$-jet non--boosted & $107.3$ & $0.108$ & $0.099$ & $0.177$ & $129.1$ & $0.087$ & $0.099$ & $0.251$ \\
 $\quad$ $1$-jet boosted & $92.4$ & $0.204$ & $0.173$ & $0.038$ & $122.8$ & $0.085$ & $0.081$ & $0.335$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $94.6$ & $0.198$ & $0.171$ & $0.213$ & $123.4$ & $0.088$ & $0.088$ & $0.846$ \\
\hline
\end{tabular}

\begin{tabular}{|l|cccc|cccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{cSVfit, $\kappa=0$} & \multicolumn{4}{c|}{cSVfit, $\kappa=5$} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $128.8$ & $0.107$ & $0.169$ & $-$ & $115.6$ & $0.081$ & $0.103$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $104.7$ & $0.107$ & $0.157$ & $-$ & $99.8$ & $0.099$ & $0.146$ & $-$ \\
 $\quad$ $1$-jet boosted & $91.9$ & $0.092$ & $0.100$ & $-$ & $89.0$ & $0.093$ & $0.099$ & $-$ \\
 $\quad$ $2$-jet VBF & $91.9$ & $0.091$ & $0.090$ & $-$ & $89.4$ & $0.088$ & $0.098$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $143.6$ & $0.097$ & $0.153$ & $0.161$ & $127.6$ & $0.079$ & $0.093$ & $0.164$ \\
 $\quad$ $1$-jet non--boosted & $136.8$ & $0.093$ & $0.126$ & $0.255$ & $126.5$ & $0.086$ & $0.099$ & $0.246$ \\
 $\quad$ $1$-jet boosted & $124.7$ & $0.083$ & $0.081$ & $0.338$ & $121.2$ & $0.086$ & $0.082$ & $0.348$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $125.7$ & $0.088$ & $0.096$ & $0.734$ & $121.6$ & $0.088$ & $0.087$ & $0.807$ \\
\hline
\end{tabular}

\begin{tabular}{|l|cccc|cccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{4}{c|}{SVfitMEM, $\kappa=5$} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $128.1$ & $0.113$ & $0.156$ & $-$ & $115.6$ & $0.078$ & $0.107$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $104.8$ & $0.106$ & $0.157$ & $-$ & $99.8$ & $0.107$ & $0.147$ & $-$ \\
 $\quad$ $1$-jet boosted & $91.8$ & $0.090$ & $0.100$ & $-$ & $89.1$ & $0.092$ & $0.100$ & $-$ \\
 $\quad$ $2$-jet VBF & $91.9$ & $0.096$ & $0.087$ & $-$ & $89.1$ & $0.098$ & $0.094$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $142.2$ & $0.098$ & $0.140$ & $0.150$ & $127.9$ & $0.085$ & $0.098$ & $0.165$ \\
 $\quad$ $1$-jet non--boosted & $136.5$ & $0.097$ & $0.120$ & $0.248$ & $127.0$ & $0.090$ & $0.102$ & $0.234$ \\
 $\quad$ $1$-jet boosted & $124.8$ & $0.083$ & $0.082$ & $0.349$ & $121.3$ & $0.088$ & $0.081$ & $0.339$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $125.6$ & $0.086$ & $0.095$ & $0.847$ & $121.9$ & $0.091$ & $0.086$ & $0.768$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (S) and $\PZ/\Pggx \to \Pgt\Pgt$ background (B) events, 
  selected in different event categories in the $\tauh\tauh$ decay channel.
  The improvement in signal-to-background separation is quantified by the ratio $\textrm{S}/(\textrm{S} + \textrm{B})$,
  computed within a mass window containing $68\%$ of signal events.
  The computation of the ratio $\textrm{S}/(\textrm{S} + \textrm{B})$ and the difference between the two resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  is explained in the text.
}
\label{tab:resolutions_sm_tautau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|cccc|cccc|}
\hline
\multicolumn{9}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{$m_{\vis}$} & \multicolumn{4}{c|}{SVfitSA} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $66.8$ & $0.123$ & $0.146$ & $-$ & $95.4$ & $0.117$ & $0.134$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $64.7$ & $0.147$ & $0.170$ & $-$ & $94.5$ & $0.117$ & $0.133$ & $-$ \\
 $\quad$ $1$-jet boosted & $53.3$ & $0.242$ & $0.278$ & $-$ & $90.4$ & $0.096$ & $0.096$ & $-$ \\
 $\quad$ $2$-jet VBF & $56.0$ & $0.336$ & $0.295$ & $-$ & $92.5$ & $0.119$ & $0.152$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $80.6$ & $0.172$ & $0.200$ & $0.008$ & $119.4$ & $0.161$ & $0.157$ & $0.012$ \\
 $\quad$ $1$-jet non--boosted & $79.8$ & $0.190$ & $0.217$ & $0.016$ & $122.8$ & $0.137$ & $0.137$ & $0.046$ \\
 $\quad$ $1$-jet boosted & $71.4$ & $0.261$ & $0.291$ & $0.020$ & $122.9$ & $0.092$ & $0.089$ & $0.280$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $74.2$ & $0.249$ & $0.263$ & $0.126$ & $122.9$ & $0.103$ & $0.101$ & $0.575$ \\
\hline
\end{tabular}

\begin{tabular}{|l|cccc|cccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{cSVfit, $\kappa=0$} & \multicolumn{4}{c|}{cSVfit, $\kappa=4$} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $121.6$ & $0.178$ & $0.434$ & $-$ & $94.8$ & $0.122$ & $0.136$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $103.5$ & $0.130$ & $0.205$ & $-$ & $93.7$ & $0.119$ & $0.134$ & $-$ \\
 $\quad$ $1$-jet boosted & $92.1$ & $0.088$ & $0.101$ & $-$ & $89.8$ & $0.099$ & $0.092$ & $-$ \\
 $\quad$ $2$-jet VBF & $94.5$ & $0.127$ & $0.185$ & $-$ & $91.8$ & $0.106$ & $0.139$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $150.6$ & $0.176$ & $0.403$ & $0.011$ & $119.2$ & $0.166$ & $0.159$ & $0.011$ \\
 $\quad$ $1$-jet non--boosted & $136.4$ & $0.134$ & $0.218$ & $0.041$ & $122.3$ & $0.136$ & $0.135$ & $0.047$ \\
 $\quad$ $1$-jet boosted & $125.4$ & $0.087$ & $0.091$ & $0.265$ & $122.1$ & $0.093$ & $0.088$ & $0.288$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $127.3$ & $0.094$ & $0.130$ & $0.404$ & $122.0$ & $0.103$ & $0.102$ & $0.579$ \\
\hline
\end{tabular}

\begin{tabular}{|l|cccc|cccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{4}{c|}{SVfitMEM, $\kappa=4$} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $116.4$ & $0.161$ & $0.292$ & $-$ & $94.0$ & $0.124$ & $0.139$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $102.8$ & $0.131$ & $0.195$ & $-$ & $92.8$ & $0.118$ & $0.137$ & $-$ \\
 $\quad$ $1$-jet boosted & $92.5$ & $0.093$ & $0.097$ & $-$ & $89.5$ & $0.098$ & $0.100$ & $-$ \\
 $\quad$ $2$-jet VBF & $94.0$ & $0.107$ & $0.186$ & $-$ & $91.5$ & $0.126$ & $0.137$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $145.3$ & $0.168$ & $0.270$ & $0.011$ & $118.4$ & $0.168$ & $0.159$ & $0.011$ \\
 $\quad$ $1$-jet non--boosted & $135.4$ & $0.134$ & $0.193$ & $0.041$ & $121.6$ & $0.139$ & $0.140$ & $0.046$ \\
 $\quad$ $1$-jet boosted & $125.5$ & $0.088$ & $0.092$ & $0.273$ & $122.1$ & $0.092$ & $0.090$ & $0.290$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $127.5$ & $0.095$ & $0.124$ & $0.449$ & $121.9$ & $0.104$ & $0.102$ & $0.575$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (S) and $\PZ/\Pggx \to \Pgt\Pgt$ background (B) events, 
  selected in different event categories in the $\Pgm\tauh$ decay channel.
  The improvement in signal-to-background separation is quantified by the ratio $\textrm{S}/(\textrm{S} + \textrm{B})$,
  computed within a mass window containing $68\%$ of signal events.
  The computation of the ratio $\textrm{S}/(\textrm{S} + \textrm{B})$ and the difference between the two resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  is explained in the text.
}
\label{tab:resolutions_sm_mutau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|cccc|cccc|}
\hline
\multicolumn{9}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{$m_{\vis}$} & \multicolumn{4}{c|}{SVfitSA} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $48.1$ & $0.196$ & $0.274$ & $-$ & $88.2$ & $0.200$ & $0.228$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $47.0$ & $0.216$ & $0.265$ & $-$ & $89.5$ & $0.170$ & $0.192$ & $-$ \\
 $\quad$ $1$-jet boosted & $38.2$ & $0.304$ & $0.456$ & $-$ & $90.0$ & $0.116$ & $0.123$ & $-$ \\
 $\quad$ $2$-jet VBF & $41.0$ & $0.174$ & $0.349$ & $-$ & $89.2$ & $0.167$ & $0.096$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $55.6$ & $0.240$ & $0.324$ & $0.003$ & $108.4$ & $0.244$ & $0.263$ & $0.003$ \\
 $\quad$ $1$-jet non--boosted & $55.2$ & $0.250$ & $0.334$ & $0.006$ & $117.3$ & $0.209$ & $0.191$ & $0.010$ \\
 $\quad$ $1$-jet boosted & $49.7$ & $0.303$ & $0.429$ & $0.013$ & $123.3$ & $0.100$ & $0.099$ & $0.157$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $51.2$ & $0.291$ & $0.383$ & $0.056$ & $122.1$ & $0.142$ & $0.116$ & $0.463$ \\
\hline
\end{tabular}

\begin{tabular}{|l|cccc|cccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{cSVfit, $\kappa=0$} & \multicolumn{4}{c|}{cSVfit, $\kappa=3$} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $159.8$ & $0.307$ & $0.827$ & $-$ & $92.8$ & $0.202$ & $0.246$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $106.9$ & $0.174$ & $0.408$ & $-$ & $92.0$ & $0.166$ & $0.199$ & $-$ \\
 $\quad$ $1$-jet boosted & $92.6$ & $0.099$ & $0.138$ & $-$ & $90.0$ & $0.114$ & $0.120$ & $-$ \\
 $\quad$ $2$-jet VBF & $95.5$ & $0.103$ & $0.169$ & $-$ & $89.8$ & $0.138$ & $0.104$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $174.4$ & $0.258$ & $0.622$ & $0.004$ & $114.7$ & $0.243$ & $0.268$ & $0.003$ \\
 $\quad$ $1$-jet non--boosted & $140.2$ & $0.172$ & $0.320$ & $0.014$ & $120.6$ & $0.196$ & $0.191$ & $0.011$ \\
 $\quad$ $1$-jet boosted & $127.1$ & $0.089$ & $0.116$ & $0.144$ & $123.2$ & $0.098$ & $0.104$ & $0.157$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $129.2$ & $0.106$ & $0.187$ & $0.464$ & $122.7$ & $0.131$ & $0.122$ & $0.463$ \\
\hline
\end{tabular}

\begin{tabular}{|l|cccc|cccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{4}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{4}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-9}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\tfrac{S}{S+B}$ \\
\hline
$\PZ \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $140.4$ & $0.258$ & $0.333$ & $-$ & $89.0$ & $0.209$ & $0.237$ & $-$ \\
 $\quad$ $1$-jet non--boosted & $105.2$ & $0.171$ & $0.356$ & $-$ & $90.2$ & $0.176$ & $0.197$ & $-$ \\
 $\quad$ $1$-jet boosted & $93.0$ & $0.103$ & $0.139$ & $-$ & $90.0$ & $0.118$ & $0.123$ & $-$ \\
 $\quad$ $2$-jet VBF & $95.0$ & $0.111$ & $0.159$ & $-$ & $89.5$ & $0.175$ & $0.110$ & $-$ \\
SM $\Pg\Pg \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $0$-jet & $161.2$ & $0.233$ & $0.321$ & $0.004$ & $110.4$ & $0.255$ & $0.271$ & $0.003$ \\
 $\quad$ $1$-jet non--boosted & $138.6$ & $0.168$ & $0.269$ & $0.014$ & $118.8$ & $0.212$ & $0.194$ & $0.010$ \\
 $\quad$ $1$-jet boosted & $127.9$ & $0.088$ & $0.119$ & $0.148$ & $123.7$ & $0.099$ & $0.101$ & $0.164$ \\
SM $\Pquark\APquark \to \PHiggs$, $\PHiggs \to \Pgt\Pgt$: & & & & & & & & \\ 
 $\quad$ $2$-jet VBF & $129.6$ & $0.107$ & $0.175$ & $0.364$ & $122.6$ & $0.138$ & $0.118$ & $0.463$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm
  in simulated SM $\PHiggs \to \Pgt\Pgt$ signal (S) and $\PZ/\Pggx \to \Pgt\Pgt$ background (B) events, 
  selected in different event categories in the $\Pe\Pgm$ decay channel.
  The improvement in signal-to-background separation is quantified by the ratio $\textrm{S}/(\textrm{S} + \textrm{B})$,
  computed within a mass window containing $68\%$ of signal events.
  The computation of the ratio $\textrm{S}/(\textrm{S} + \textrm{B})$ and the difference between the two resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  is explained in the text.
}
\label{tab:resolutions_sm_emu}
\end{table}
%----------------------------------------------------------------------------------------------------

The choice of quantifying the resolution in terms of the ratio $\sigma/\textrm{M}$ is motivated 
by the fact that the distributions in $m_{\Pgt\Pgt}$, respectively in $m_{\vis}$, may be shifted with respect to $m_{\Pgt\Pgt}^{\true}$.
While the distributions in $m_{\Pgt\Pgt}$ reconstructed by the different versions of the SVfit algorithm,
as well as by the CA method, peak close to $m_{\Pgt\Pgt}^{\true}$,
the distributions in $m_{\vis}$ exhibit significant shifts towards lower mass.
The shift of the $m_{\vis}$ distribution is in general highest for events in the $\Pe\Pgm$ decay channel and lowest for events in the $\tauh\tauh$ decay channel,
reflecting the fact that the visible $\Pgt$ decay products typically carry a lower fraction of $\Pgt$ lepton energy in leptonic compared to hadronic $\Pgt$ decays.
The shift is more pronounced in events selected in the $1$-jet and $2$-jet VBF categories and less pronounced in the $0$-jet category.
In particular in the $\tauh\tauh$ channel,
the $\pT$ cuts that are applied on the $\tauh$ remove most of the $\PZ/\Pggx \to \Pgt\Pgt$ events in the $0$-jet category,
except for a few events with large $m_{\vis}$.
The events selected in the $1$-jet and $2$-jet VBF categories typically have smaller $m_{\vis}$, as $m_{\vis}$ decreases proportional to the cosine of the angle between the $\Pgt$ leptons,
$m_{\vis} \approx \pT^{\vis(1)} \, \cosh\eta_{\vis(1)} \cdot \pT^{\vis(2)} \, \cosh\eta_{\vis(2)} \cdot \left( 1 - \cos\sphericalangle(\Pgt,\Pgt) \right)$.
All algorithms can be trivially calibrated such that the median of each mass distribution coincides with the true mass of the $\Pgt$ lepton pair,
by scaling the output of the algorithm by a suitably chosen constant.
The advantage of quantifying the resolution in terms of the ratio $\sigma/\textrm{M}$ is that the ratio
is invariant under such scaling.

The ratio of the SM $\PHiggs \to \Pgt\Pgt$ signal to the $\PZ/\Pggx \to \Pgt\Pgt$ background in general increases with jet multiplicity
and with the $\pT$ of the $\Pgt$ lepton pair ($\pT^{\PHiggs}$ respectively $\pT^{\PZ}$).
The categories with the highest signal-to-background ratio, the $1$-jet boosted and the $2$-jet VBF category,
in fact provide most of the sensitivity of the SM $\PHiggs \to \Pgt\Pgt$ analysis.
The improvement in mass resolution provided by the SVfit algorithm is largest in these categories,
enhancing the separation of the SM $\PHiggs \to \Pgt\Pgt$ signal from the $\PZ/\Pggx \to \Pgt\Pgt$ background where it matters most.
In the SM $\PHiggs \to \Pgt\Pgt$ analysis performed by the CMS collaboration during LHC Run $1$,
the use of $m_{\Pgt\Pgt}$ reconstructed by the SVfit algorithm has increased the expected significance for observing a signal by $\approx 40\%$ compared to $m_{\vis}$~\cite{HIG-13-004},
corresponding to a gain of a factor two in luminosity.

The reconstruction of $m_{\Pgt\Pgt}$ by the CA method performs suboptimal compared to SVfit.
In particular the pronounced high mass tails in the $m_{\Pgt\Pgt}$ distribution, arising from resolution effects,
significantly reduce the sensitivity for observing a signal,
as they cause a sizeable fraction of $\PZ/\Pggx \to \Pgt\Pgt$ background events
to be reconstructed near the signal region $m_{\Pgt\Pgt} \approx 125$~\GeV.
A further disadvantage of the CA method is that it fails to yield a physical solution for approximately half of the events,
whereas the SVfit algorithm provides a physical solution for every event. 

The performance of the cSVfit algorithm to reconstruct the $\pT$,
$\eta$, and $\phi$ of the $\Pgt$ lepton pair is studied in SM $\PHiggs
\to \Pgt\Pgt$ signal events produced via the gluon fusion process
and in $\PZ/\Pggx \to \Pgt\Pgt$ background events,
separately for the decay channels $\tauh\tauh$, $\Pgm\tauh$, and $\Pe\Pgm$.
Distributions of the difference between reconstructed and true $\pT$,
$\eta$, and $\phi$ of the $\PHiggs$ boson are shown in
Fig.~\ref{fig:resolutions_sm_pT_eta_and_phi}.
Compared to the case that the $\PHiggs$ boson $\pT$ and $\phi$ are
reconstructed by taking the vectorial sum of the momenta of the visible $\Pgt$
decay products and of $\MET$, the cSVfit algorithm improves the
resolution by $10$--$20\%$. The pseudo-rapidity $\eta$ of the
$\PHiggs$ boson can only be reconstructed with the cSVfit algorithm.
Typical resolutions on the $\pT$, $\eta$, and $\phi$ of the $\PHiggs$ boson,
reconstructed by the cSVfit algorithm, amount to $10$~\GeV, $0.4$~\rad, and $0.8$~\rad,
respectively.

%----------------------------------------------------------------------------------------------------
%
% resolution in ditau pT, eta, and phi reconstructed by the cSVfit algorithm in SM Higgs->tautau signal events,
% compared to reconstructing the Higgs boson pT and phi by computing the sum of momenta of the visible tau decay products and MET
%

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(180,210)(0,0)
\put(-2.5, -2.0){\mbox{\includegraphics*[height=214mm]
{plots_oct_25/Higgs_resolutions_pT.pdf}}}
\put(50.5, -2.0){\mbox{\includegraphics*[height=214mm]
{plots_oct_25/Higgs_resolutions_eta.pdf}}}
\put(103.5, -2.0){\mbox{\includegraphics*[height=214mm]
{plots_oct_25/Higgs_resolutions_phi.pdf}}}
\end{picture}
\end{center}
\caption{
  Resolution on $\pT$ (a,d,g), $\eta$ (b,e,h), and $\phi$ (c,f,i) of the $\Pgt$ lepton
  pair in SM $\PHiggs \to \Pgt\Pgt$ signal and $\PZ/\Pggx \to
  \Pgt\Pgt$ background events,
  separately for the decay channels $\tauh\tauh$ (a,b,c), $\Pgm\tauh$ (d,e,f),
  and $\Pe\Pgm$ (g,h,i).
  The SM $\PHiggs \to \Pgt\Pgt$ signal events are produced via the
  gluon fusion process.
  The resolutions on $\pT$ and $\phi$ achieved by computing the sum of
  the momenta of the visible $\Pgt$ decay products and $\MET$ are shown for comparison.
}
\label{fig:resolutions_sm_pT_eta_and_phi}
\end{figure}
%----------------------------------------------------------------------------------------------------

Distributions in $m_{\Pgt\Pgt}$ reconstructed by different versions of
the SVfit algorithm, by the CA method, and of $m_{\vis}$ in hypothetic signal events containing heavy
pseudoscalar Higgs bosons are shown in
Figs.~\ref{fig:massDistributions_mssm_tautau}
to~\ref{fig:massDistributions_mssm_emu}.
The distributions in $m_{\Pgt\Pgt}$ reconstructed by the cSVfit and
SVfitMEM algorithms are shown for the case that the artificial regularization
term described in Section~\ref{sec:mem_logM} is used and for the case that it is not used. 
The reduction of high mass tails in the $m_{\Pgt\Pgt}$ distribution
for the irreducible $\PZ/\Pggx \to \Pgt\Pgt$
background is important not only in the context of the SM $\PHiggs \to
\Pgt\Pgt$ analysis, but also for searches for heavy resonances, as the signal cross section is expected to fall steeply as function of resonance mass,
such that potential high mass signals would likely be buried underneath the high mass tail of the irreducible $\PZ/\Pggx \to \Pgt\Pgt$ background otherwise.

%----------------------------------------------------------------------------------------------------
%
% mTauTau distributions in MSSM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
\put(-2.5, -3.0){\mbox{\includegraphics*[height=220mm]
  {plots_mar27_2017/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu_and_Zprime_hadhad_log_ratio.pdf}}}
\put(108.0, 9.0){\mbox{\includegraphics*[height=38mm]
  {plots_mar27_2017/makeSVfitMEM_PerformancePlots_legend_hadhad.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method and different versions of the SVfit algorithm in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass $m_{\PHiggsps}$:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), $1200$~\GeV (e), and $2600$~\GeV (f), as well as in $\PZ' \to \Pgt\Pgt$ events of mass $m_{\PZ'} = 2500$~\GeV (g).
  The events are selected in the $\tauh\tauh$ decay channel.
  The axis of abscissae ranges from $0.15$ to $8$.
}
\label{fig:massDistributions_mssm_tautau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
\put(-2.5, -3.0){\mbox{\includegraphics*[height=220mm]
  {plots_mar27_2017/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu_and_Zprime_muhad_log_ratio.pdf}}}
\put(108.0, 9.0){\mbox{\includegraphics*[height=38mm]
  {plots_mar27_2017/makeSVfitMEM_PerformancePlots_legend_muhad.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method and different versions of the SVfit algorithm in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass $m_{\PHiggsps}$:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), $1200$~\GeV (e), and $2600$~\GeV (f), as well as in $\PZ' \to \Pgt\Pgt$ events of mass $m_{\PZ'} = 2500$~\GeV (g).
  The events are selected in the $\Pgm\tauh$ decay channel.
  The axis of abscissae ranges from $0.15$ to $8$.
}
\label{fig:massDistributions_mssm_mutau}
\end{figure}

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,216)(0,0)
\put(-2.5, -3.0){\mbox{\includegraphics*[height=220mm]
  {plots_mar27_2017/makeSVfitMEM_PerformancePlots_HiggsSUSYGluGlu_and_Zprime_emu_log_ratio.pdf}}}
\put(108.0, 9.0){\mbox{\includegraphics*[height=38mm]
  {plots_mar27_2017/makeSVfitMEM_PerformancePlots_legend_emu.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\Pgt\Pgt}$ reconstructed by the CA method and different versions of the SVfit algorithm in simulated $\PHiggsps \to \Pgt\Pgt$ signal events of different mass $m_{\PHiggsps}$:
  $200$~\GeV (a), $300$~\GeV (b), $500$~\GeV (c), $800$~\GeV (d), $1200$~\GeV (e), and $2600$~\GeV (f), as well as in $\PZ' \to \Pgt\Pgt$ events of mass $m_{\PZ'} = 2500$~\GeV (g).
  The events are selected in the $\Pe\Pgm$ decay channel.
  The axis of abscissae ranges from $0.15$ to $8$.
}
\label{fig:massDistributions_mssm_emu}
\end{figure}
%----------------------------------------------------------------------------------------------------

The SVfit algorithm significantly improves the separation of the
heavy Higgs boson signal from the irreducible $\PZ/\Pggx \to \Pgt\Pgt$
background in all three decay channels.
Numerical values for the median $\textrm{M}$ and for the ratio $\sigma/\textrm{M}$ of the
distribution, are given in Tables~\ref{tab:resolutions_mssm_tautau}
to~\ref{tab:resolutions_mssm_emu}.
The tables also give the median $\textrm{M}$ and ratio $\sigma/\textrm{M}$
for a heavy spin $1$ resonance of mass $2500$~\GeV .

%----------------------------------------------------------------------------------------------------
%
% mass resolutions in MSSM Higgs->tautau signal and Z/gamma*->tautau background events
%
\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $148$ & $0.172$ & $0.173$ & $191$ & $0.137$ & $0.111$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $202$ & $0.215$ & $0.233$ & $278$ & $0.176$ & $0.118$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $318$ & $0.271$ & $0.272$ & $455$ & $0.205$ & $0.128$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $487$ & $0.302$ & $0.305$ & $733$ & $0.205$ & $0.118$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $724$ & $0.318$ & $0.312$ & $1101$ & $0.206$ & $0.116$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1078$ & $0.329$ & $0.314$ & $1662$ & $0.196$ & $0.110$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $1553$ & $0.339$ & $0.316$ & $2414$ & $0.198$ & $0.103$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $1486$ & $0.340$ & $0.325$ & $2196$ & $0.245$ & $0.147$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=5$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $207$ & $0.116$ & $0.155$ & $188$ & $0.140$ & $0.113$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $303$ & $0.135$ & $0.158$ & $275$ & $0.178$ & $0.118$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $497$ & $0.140$ & $0.148$ & $453$ & $0.202$ & $0.127$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $788$ & $0.138$ & $0.135$ & $731$ & $0.205$ & $0.116$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $1179$ & $0.141$ & $0.125$ & $1101$ & $0.201$ & $0.113$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1769$ & $0.134$ & $0.117$ & $1661$ & $0.193$ & $0.107$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $2560$ & $0.139$ & $0.113$ & $2413$ & $0.192$ & $0.102$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $2445$ & $0.182$ & $0.154$ & $2219$ & $0.242$ & $0.140$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=5$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $203$ & $0.118$ & $0.138$ & $188$ & $0.139$ & $0.112$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $298$ & $0.146$ & $0.144$ & $273$ & $0.179$ & $0.124$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $495$ & $0.168$ & $0.234$ & $451$ & $0.211$ & $0.132$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $791$ & $0.164$ & $0.419$ & $723$ & $0.207$ & $0.123$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $1166$ & $0.151$ & $0.134$ & $1088$ & $0.204$ & $0.118$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1684$ & $0.152$ & $0.104$ & $1619$ & $0.193$ & $0.112$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $2399$ & $0.183$ & $0.106$ & $2325$ & $0.205$ & $0.117$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $2222$ & $0.220$ & $0.142$ & $2131$ & $0.243$ & $0.152$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm,
  in simulated signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$
  and in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events.
  The events are selected in the $\tauh\tauh$ decay channel.
  The difference between the two resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  is explained in the text.
}
\label{tab:resolutions_mssm_tautau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $113$ & $0.252$ & $0.288$ & $187$ & $0.201$ & $0.139$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $153$ & $0.294$ & $0.352$ & $276$ & $0.237$ & $0.138$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $236$ & $0.346$ & $0.412$ & $460$ & $0.266$ & $0.134$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $361$ & $0.380$ & $0.453$ & $742$ & $0.259$ & $0.118$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $529$ & $0.408$ & $0.477$ & $1121$ & $0.252$ & $0.108$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $779$ & $0.434$ & $0.499$ & $1694$ & $0.244$ & $0.099$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $1111$ & $0.454$ & $0.511$ & $2463$ & $0.228$ & $0.095$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $1077$ & $0.438$ & $0.485$ & $2212$ & $0.312$ & $0.155$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=4$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $214$ & $0.138$ & $0.292$ & $187$ & $0.200$ & $0.138$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $313$ & $0.136$ & $0.261$ & $276$ & $0.235$ & $0.137$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $510$ & $0.132$ & $0.226$ & $461$ & $0.261$ & $0.129$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $810$ & $0.129$ & $0.191$ & $742$ & $0.250$ & $0.116$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $1204$ & $0.127$ & $0.165$ & $1121$ & $0.244$ & $0.105$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1802$ & $0.122$ & $0.152$ & $1695$ & $0.235$ & $0.098$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $2603$ & $0.118$ & $0.147$ & $2467$ & $0.221$ & $0.094$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $2541$ & $0.165$ & $0.259$ & $2234$ & $0.303$ & $0.149$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=4$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $208$ & $0.136$ & $0.217$ & $186$ & $0.200$ & $0.135$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $306$ & $0.156$ & $0.208$ & $274$ & $0.241$ & $0.139$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $504$ & $0.161$ & $0.171$ & $458$ & $0.270$ & $0.131$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $795$ & $0.156$ & $0.155$ & $733$ & $0.256$ & $0.122$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $1181$ & $0.152$ & $0.113$ & $1111$ & $0.260$ & $0.107$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1708$ & $0.167$ & $0.091$ & $1641$ & $0.239$ & $0.103$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $2433$ & $0.213$ & $0.092$ & $2350$ & $0.255$ & $0.109$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $2207$ & $0.257$ & $0.149$ & $2081$ & $0.298$ & $0.178$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm,
  in simulated signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$
  and in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events.
  The events are selected in the $\Pgm\tauh$ decay channel.
  The difference between the two resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  is explained in the text.
}
\label{tab:resolutions_mssm_mutau}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|l|ccc|ccc|}
\hline
\multicolumn{7}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{$m_{\vis}$} & \multicolumn{3}{c|}{SVfitSA} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $77$ & $0.318$ & $0.426$ & $181$ & $0.303$ & $0.187$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $104$ & $0.372$ & $0.514$ & $272$ & $0.355$ & $0.176$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $162$ & $0.427$ & $0.564$ & $464$ & $0.351$ & $0.136$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $246$ & $0.463$ & $0.620$ & $744$ & $0.348$ & $0.133$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $357$ & $0.487$ & $0.661$ & $1130$ & $0.353$ & $0.116$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $538$ & $0.517$ & $0.659$ & $1727$ & $0.320$ & $0.094$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $748$ & $0.528$ & $0.716$ & $2501$ & $0.312$ & $0.086$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $733$ & $0.522$ & $0.694$ & $2198$ & $0.438$ & $0.190$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{cSVfit, $\kappa=0$} & \multicolumn{3}{c|}{cSVfit, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $223$ & $0.162$ & $0.463$ & $186$ & $0.272$ & $0.191$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $321$ & $0.155$ & $0.444$ & $279$ & $0.325$ & $0.167$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $518$ & $0.136$ & $0.369$ & $469$ & $0.322$ & $0.133$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $815$ & $0.130$ & $0.310$ & $751$ & $0.319$ & $0.128$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $1214$ & $0.126$ & $0.263$ & $1141$ & $0.317$ & $0.111$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1812$ & $0.115$ & $0.202$ & $1732$ & $0.267$ & $0.097$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $2607$ & $0.119$ & $0.172$ & $2518$ & $0.268$ & $0.089$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $2578$ & $0.186$ & $0.495$ & $2268$ & $0.411$ & $0.181$ \\
\hline
\end{tabular}

\begin{tabular}{|l|ccc|ccc|}
\hline
\multirow{2}{17mm}{Sample} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=0$} & \multicolumn{3}{c|}{SVfitMEM, $\kappa=3$} \\
\cline{2-7}
 & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ & $\textrm{M}$~[\GeV\unskip] & $\sigma_{l}/\textrm{M}$ & $\sigma_{h}/\textrm{M}$ \\
\hline
$\PHiggsps \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PHiggsps} = 200$~\GeV & $214$ & $0.151$ & $0.397$ & $183$ & $0.288$ & $0.181$ \\
 $\quad$ $m_{\PHiggsps} = 300$~\GeV & $316$ & $0.172$ & $0.321$ & $275$ & $0.342$ & $0.171$ \\
 $\quad$ $m_{\PHiggsps} = 500$~\GeV & $517$ & $0.146$ & $0.227$ & $471$ & $0.336$ & $0.128$ \\
 $\quad$ $m_{\PHiggsps} = 800$~\GeV & $806$ & $0.156$ & $0.200$ & $745$ & $0.320$ & $0.129$ \\
 $\quad$ $m_{\PHiggsps} = 1200$~\GeV & $1200$ & $0.154$ & $0.122$ & $1131$ & $0.342$ & $0.106$ \\
 $\quad$ $m_{\PHiggsps} = 1800$~\GeV & $1737$ & $0.179$ & $0.081$ & $1663$ & $0.285$ & $0.101$ \\
 $\quad$ $m_{\PHiggsps} = 2600$~\GeV & $2456$ & $0.270$ & $0.082$ & $2364$ & $0.333$ & $0.108$ \\
$\PZ' \to \Pgt\Pgt$: & & & & & & \\ 
 $\quad$ $m_{\PZ'} = 2500$~\GeV & $2125$ & $0.290$ & $0.198$ & $1938$ & $0.367$ & $0.270$ \\
\hline
\end{tabular}
\end{center}
\caption{
  Median $\textrm{M}$ and resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  of the distributions in $m_{\vis}$ 
  and in $m_{\Pgt\Pgt}$ reconstructed by different versions of SVfit algorithm,
  in simulated signal events containing either heavy pseudoscalar Higgs
  bosons $\PHiggsps$ or heavy spin $1$ resonances $\PZ'$
  and in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events.
  The events are selected in the $\Pe\Pgm$ decay channel.
  The difference between the two resolutions $\sigma_{l}/\textrm{M}$ and $\sigma_{h}/\textrm{M}$
  is explained in the text.
}
\label{tab:resolutions_mssm_emu}
\end{table}
%----------------------------------------------------------------------------------------------------

We interpret the fact that the performance of the SVfitMEM and cSVfit algorithms is very similar for an $\PHiggsps \to \Pgt\Pgt$ signal of mass $2600$~\GeV
and for a $\PZ' \to \Pgt\Pgt$ signal of mass $2500$~\GeV as evidence that the choice of using
the LO ME for the gluon fusion process $\Pg\Pg \to \PHiggs$ in the SVfitMEM algorithm represents no limitation for using
the SVfitMEM algorithm in data analyses of $\Pgt$ lepton pair production other than studies of Higgs boson production.

The improvement in signal-to-background separation provided by the
SVfit algorithm is illustrated in Fig.~\ref{fig:distributions_mVis_vs_SVfit}.

\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,214)(0,0)
\put(-2.5, 150.0){\mbox{\includegraphics*[height=70mm]
  {plots_oct_25/svFitPerformance_hadhad_visMass.pdf}}}
\put(80.0, 150.0){\mbox{\includegraphics*[height=70mm]
  {plots_oct_25/svFitPerformance_hadhad_svFitMass.pdf}}}
\put(-2.5, 75.0){\mbox{\includegraphics*[height=70mm]
  {plots_oct_25/svFitPerformance_muhad_visMass.pdf}}}
\put(80.0, 75.0){\mbox{\includegraphics*[height=70mm]
  {plots_oct_25/svFitPerformance_muhad_svFitMass.pdf}}}
\put(-2.5, 0.0){\mbox{\includegraphics*[height=70mm]
  {plots_oct_25/svFitPerformance_emu_visMass.pdf}}}
\put(80.0, 0.0){\mbox{\includegraphics*[height=70mm]
  {plots_oct_25/svFitPerformance_emu_svFitMass.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in $m_{\vis}$ (left) and in $m_{\Pgt\Pgt}$ reconstructed by the SVfitMEM algorithm with small positive $\kappa$ (right)
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background events and SM $\PHiggs \to \Pgt\Pgt$ respectively $\PHiggsps \to \Pgt\Pgt$ signal events,
  selected in the decay channels $\tauh\tauh$ ($\kappa = 5$, top), $\Pgm\tauh$ ($\kappa = 4$, centre), and $\Pe\Pgm$ ($\kappa = 3$, bottom).
  Hypothetic signal events containing heavy pseudoscalar Higgs bosons $\PHiggsps$ are generated for masses $m_{\PHiggsps}$ of $200$ and $300$~\GeV. 
}
\label{fig:distributions_mVis_vs_SVfit}
\end{figure}

We conclude the discussion of the performance of the SVfit algorithm
with a comparison of the computing time requirements of the SVfitMEM,
cSVfit, and SVfitSA algorithms.
The computing time is dominated by the
evaluation of the integrand during the numeric integration of Eqs.~(\ref{eq:mem_with_hadRecoil}) and~(\ref{eq:cSVfit_with_hadRecoil}), and of Eq.~(2) of Ref.~\cite{SVfit}, respectively.
The computing time requirement is expected to be
highest for the SVfitMEM algorithm, due to the time needed for evaluation of the PDF and of the TF in Eq.~(\ref{eq:mem_with_hadRecoil}).

The time for reconstructing $m_{\Pgt\Pgt}$ in a single event scales approximately linearly
with the number of evaluations of the integrand.
The SVfitMEM (SVfitSA) algorithm performs $20,000$ ($10,000$)
evaluations of the integrand per mass hypothesis
$m_{\PHiggs}^{\textrm{test}(i)}$.
The number of evaluations of the integrand per mass hypothesis $m_{\PHiggs}^{\textrm{test}(i)}$ is chosen such that the
resolution on $m_{\Pgt\Pgt}$ is within $1\%$ compared to the resolution obtained in case an infinite (very large) number of evaluations of the
integrand is performed.
The number of evaluations is higher in case of the SVfitMEM algorithm, 
accounting for the fact that the additional PDF and TF factors raise the variation of the integrand, 
such that a higher number of evaluations is neccessary in order to reach a given precision on the value of the integral.

The number of mass hypotheses tested for an event varies depending on the
conditions described in Section~\ref{sec:mem_numericalMaximization}.
For the series of $m_{\PHiggs}^{\textrm{test}(i)}$ values defined by Eq.~(\ref{eq:mTauTau_step_size}),
the number of test mass hypotheses for which the integral $\mathcal{P}$ gets computed according to Eq.~(\ref{eq:mem_with_hadRecoil}) 
increases approximately logarithmically with the true mass of the $\Pgt$ lepton pair. 
The integral $\mathcal{P}$
is typically computed for a series of $20$ to $30$ mass hypotheses $m_{\PHiggs}^{\textrm{test}(i)}$ in signal events.
The average number of test mass hypothesis varies with the decay channel.
The series is typically the longest in the $\Pe\Pgm$ channel and the shortest in the $\tauh\tauh$,
as the value of $m_{\vis}$ that is used to initialize the series is farther away respectively less far away from $m_{\Pgt\Pgt}^{\true}$,
for which the value of $\mathcal{P}$ is expected to reach its maximum $\mathcal{P}^{\textrm{max}}$.
A larger number of test mass hypotheses may be required for background events,
as the values of $\mathcal{P}$ may be almost degenerate over a large range in $m_{\PHiggs}^{\textrm{test}(i)}$.

The numeric integration is performed by the VAMP algorithm in case of
the SVfitMEM algorithm (\cf Section~\ref{sec:mem_numericalMaximization}) and by the VEGAS algorithm
in case of the SVfitSA algorithm.
In case of the cSVfit algorithm, the numeric integration is performed
by a custom implementation of the Markov chain Monte Carlo method, as described in Section~\ref{sec:classicSVfit}.
In the latter case, the integrand is evaluated $100,000$ times per event and there is no
iteration over a sequence of mass hypotheses, \cf Eq.~(\ref{eq:cSVfit_with_hadRecoil}).

The computing time is measured by CPU time, 
using a single core of a $2.30$~GHz Intel\TReg~Xeon\TReg~E$5$-$2695$ v$3$ processor.
The distribution of the CPU time, in units of seconds per event, 
spent by the SVfitMEM, cSVfit and SVfitSA algorithms
to compute $m_{\Pgt\Pgt}$ in SM $\PHiggs \to \Pgt\Pgt$ signal events and in $\PZ/\Pggx \to \Pgt\Pgt$ background events
is shown in Fig.~\ref{fig:computing_time}.
Numerical values of the mean and RMS of the distributions are given in Table~\ref{tab:computing_time}.
The cSVfit algorithm requires about $0.5$s of CPU time per event to reconstruct the mass $m_{\Pgt\Pgt}$ of the $\Pgt$ lepton pair,
as well as its $\pT$, $\eta$, $\phi$, and transverse mass $m_{T\Pgt\Pgt}$.
The CPU time is reduced by a factor $5$ to $30$ compared to the SVfitSA algorithm, 
owing to the more efficient Markov chain Monte
Carlo integration method compared to
computing the probability density $\mathcal{P}$
for a series of mass hypotheses $m_{\PHiggs}^{\textrm{test}(i)}$.
The computing time requirement of the SVfitMEM algorithm is higher by a factor $3$ to $4$ compared to the SVfitSA algorithm.

%----------------------------------------------------------------------------------------------------
%
% computing time requirements of the SVfitMEM, cSVfit, and SVfitSA in SM Higgs->tautau signal and Z/gamma*->tautau background events 
%
\begin{figure}
\setlength{\unitlength}{1mm}
\begin{center}
\begin{picture}(160,210)(0,0)
\put(-2.5, -4.0){\mbox{\includegraphics*[height=214mm]
  {plots_oct_25/Higgs_DYJets_CPU_time.pdf}}}
\end{picture}
\end{center}
\caption{
  Distributions in CPU time, in seconds per event, needed to reconstruct $m_{\Pgt\Pgt}$ by
  the SVfitMEM, cSVfit, and SVfitSA algorithms
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background (a,c,e)
  and SM $\PHiggs \to \Pgt\Pgt$ signal (b,d,f) events 
 in the decay channels $\tauh\tauh$ (a,b), $\Pgm\tauh$ (c,d),
  and $\Pe\Pgm$ (e,f).
}
\label{fig:computing_time}
\end{figure}

\begin{table}
\begin{center}
\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\tauh\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{24mm}{Algorithm} & \multicolumn{2}{c|}{$\PZ/\Pggx \to \Pgt\Pgt$} & \multicolumn{2}{c|}{SM $\PHiggs \to \Pgt\Pgt$} \\
\cline{2-5}
& Mean~[s] & RMS~[s] & Mean~[s] & RMS~[s] \\
\hline
SVfitSA & $3.51$ & $5.24$ & $3.75$ & $5.87$ \\
cSVfit & & & & \\
$\quad \kappa=0$ & $0.72$ & $0.17$ & $0.73$ & $0.18$ \\
$\quad \kappa=5$ & $0.77$ & $0.20$ & $0.78$ & $0.20$ \\
SVfitMEM & & & & \\
$\quad \kappa=0$ & $13.07$ & $6.27$ & $14.03$ & $6.89$ \\
$\quad \kappa=5$ & $10.72$ & $4.72$ & $11.44$ & $5.02$ \\
\hline
\end{tabular}

\vspace{3.5mm}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\Pgm\tauh$ decay channel} \\
\hline
\hline
\multirow{2}{24mm}{Algorithm} & \multicolumn{2}{c|}{$\PZ/\Pggx \to \Pgt\Pgt$} & \multicolumn{2}{c|}{SM $\PHiggs \to \Pgt\Pgt$} \\
\cline{2-5}
& Mean~[s\unskip] & RMS~[s\unskip] & Mean~[s\unskip] & RMS~[s\unskip] \\
\hline
SVfitSA & $5.82$ & $9.22$ & $5.02$ & $7.91$ \\
cSVfit & & & & \\
$\quad \kappa=0$ & $0.62$ & $0.11$ & $0.56$ & $0.12$ \\
$\quad \kappa=4$ & $0.73$ & $0.17$ & $0.61$ & $0.16$ \\
SVfitMEM & & & & \\
$\quad \kappa=0$ & $22.64$ & $12.99$ & $18.45$ & $10.15$ \\
$\quad \kappa=4$ & $18.38$ & $7.49$ & $15.83$ & $6.68$ \\
\hline
\end{tabular}

\vspace{3.5mm}

\begin{tabular}{|l|C{1.5cm}C{1.5cm}|C{1.5cm}C{1.5cm}|}
\hline
\multicolumn{5}{|c|}{$\Pe\Pgm$ decay channel} \\
\hline
\hline
\multirow{2}{24mm}{Algorithm} & \multicolumn{2}{c|}{$\PZ/\Pggx \to \Pgt\Pgt$} & \multicolumn{2}{c|}{SM $\PHiggs \to \Pgt\Pgt$} \\
\cline{2-5}
& Mean~[s\unskip] & RMS~[s\unskip] & Mean~[s\unskip] & RMS~[s\unskip] \\
\hline
SVfitSA & $10.26$ & $14.65$ & $7.68$ & $10.35$ \\
cSVfit & & & & \\
$\quad \kappa=0$ & $0.34$ & $0.06$ & $0.34$ & $0.06$ \\
$\quad \kappa=3$ & $0.39$ & $0.08$ & $0.37$ & $0.09$ \\
SVfitMEM & & & & \\
$\quad \kappa=0$ & $30.92$ & $16.59$ & $19.37$ & $12.29$ \\
$\quad \kappa=3$ & $22.56$ & $7.70$ & $16.62$ & $7.43$ \\
\hline
\end{tabular}
\end{center}
\caption{
 CPU time, in seconds per event, needed to reconstruct $m_{\Pgt\Pgt}$ by
  the SVfitMEM, cSVfit, and SVfitSA algorithms
  in simulated $\PZ/\Pggx \to \Pgt\Pgt$ background
  and SM $\PHiggs \to \Pgt\Pgt$ signal events 
  in the decay channels $\tauh\tauh$, $\Pgm\tauh$,
  and $\Pe\Pgm$.
}
\label{tab:computing_time}
\end{table}
%----------------------------------------------------------------------------------------------------

Considering that the resolution on $m_{\Pgt\Pgt}$,
quantified by the ratio $\sigma/\textrm{M}$, achieved
by the SVfitMEM and cSVfit algorithms is almost identical, we find that the cSVfit
algorithm represents the best compromise between physics performance and computing time requirements.

The optimal resolution on $m_{\Pgt\Pgt}$, quantified by the ratio $\sigma/\textrm{M}$,
is achieved in case an artificial regularization term of the type described in Section~\ref{sec:mem_logM}, with small positive $\kappa$,
is added to the likelihood function.
We expect the optimal choice of $\kappa$ to depend on the rates of signal and background processes as well as on the experimental resolution,
and we recommend to perform a reoptimization of $\kappa$ in practical applications of our algorithm.

The merit of the SVfitMEM algorithm is that the 
formalism to treat $\Pgt$ lepton decays in the ME method, developed
for the SVfitMEM algorithm, can be used
in future applications of the ME method to data analyses with $\Pgt$
leptons in the final state.
