\section{The Matrix element method}
\label{sec:mem}

In the ME method, an estimate for the unknown model parameter $\theta$
is obtained by maximizing the probability density:
\begin{align}
\mathcal{P}(\bm{y}|\theta) = & \frac{\Omega(\bm{y})}{\sigma(\theta) \,
\mathcal{A}(\theta)} \, \int \, dx_{a} \, dx_{b} \,
d\Phi_{n} \, \frac{f(x_{a}) \, f(x_{b})}{2 \, x_{a} \, x_{b} \, s} \, (2\pi)^{4} \,
\delta( x_{a} \, E_{a} + x_{b} \, E_{b} - \sum_{i}^{n}
E_{(i)}) \cdot \nonumber \\
 & \quad \delta^{3}( x_{a} \, \bm{p}^{a} + x_{b} \, \bm{p}^{b} - \sum_{i}^{n}
\bm{p}^{(i)}) \, 
  \vert \mathcal{M}(\bm{p},\theta) \vert^{2} \, W(\bm{y}|\bm{p}) \,
  \epsilon(\bm{p},\theta) 
\label{eq:mem}
\end{align}
with respect to $\theta$.
The symbols $E_{a}$ and $E_{b}$ and $\bm{p}^{a}$ and $\bm{p}^{b}$ denote, respectively, the energies and momenta of the two colliding protons,
$\sqrt{s}$ represents the centre-of-mass energy,
$x_{a}$ and $x_{b}$ denote the Bjorken scaling variables~\cite{Bjorkenx}
and $f(x_{a})$ and $f(x_{b})$ the corresponding parton distribution
functions (PDF).
We use the MSTW 2008 LO PDF set~\cite{MSTW} to evaluate $f(x_{a})$ and $f(x_{b})$.
We furthermore denote by $n$ the number of particles in the final state,
by $\bm{p}^{(i)}$ the momentum of the $i$-th final state particle
and by $d\Phi_{n} = \prod_{i}^{n} \,
\frac{d^{3}\bm{p}^{(i)}}{(2\pi)^{3} \, 2 E_{(i)}}$ the differential $n$-particle
phase space element.
Vector quantities are represented by bold letters.
The symbol $\vert \mathcal{M}(\bm{p},\theta) \vert^{2}$ represents the
squared modulus of the ME for
the process.
The $\delta$-functions $\delta( x_{a} \, E_{a} + x_{b} \, E_{b} - \sum_{i}^{n} E_{(i)})$
and $\delta^{3}( x_{a} \, \bm{p}^{a} + x_{b} \, \bm{p}^{b} - \sum_{i}^{n} \bm{p}^{(i)})$ 
impose energy and momentum conservation.
The set of observables measured in the
detector is denoted by $\bm{y}$.
The function $W(\bm{y}|\bm{p})$ represents the probability density to
observe the measured values $\bm{y}$, given a point $\bm{p}$ in the
$n$-particle phase space, and
is referred to as ``transfer function'' (TF) in the
literature, while the function $\Omega(\bm{y})$ is referred to as ``indicator function''~\cite{Fiedler:2010sg,Volobouev:2011vb}.
The value of the indicator function is $1$ for events which pass the event selection criteria and $0$ otherwise.
The efficiency for an event originating at the phase space point
$\bm{p}$ to pass the event selection, \ie to end up with measured
observables $\bm{y}$ for which $\Omega(\bm{y}) = 1$,
is denoted by $\epsilon(\bm{p},\theta)$. 
The symbol $\sigma(\theta)$ corresponds to the cross section for the process under study,
in the case considered in this paper the production, in $\Pp\Pp$
collisions, of a $\PHiggs$ boson decaying into a pair of $\Pgt$ leptons
with subsequent decay of the $\Pgt$ pair.
The symbol $\mathcal{A}(\theta)$ represents the acceptance of the
event selection, that is, the percentage of events which pass the event
selection criteria.
Division by $\sigma(\theta) \cdot \mathcal{A}(\theta)$ ensures that $\mathcal{P}(\bm{y}|\theta)$ has
the correct normalization required for a probability density, 
i.e. $\int \, d\bm{y} \, \mathcal{P}(\bm{y}|\theta) = 1$ for every $\theta$, 
provided that the TF satisfy the normalization condition
$\int \, d\bm{y} \, \Omega(\bm{y}) \, W(\bm{y}|\bm{p}) = 1$
for every $\bm{p}$.

The meaning of Eq.~(\ref{eq:mem}) is as follows.
The best estimate for the unknown model parameter $\theta$ is given by the
value $\hat{\theta}$ which maximizes the probability density to observe precisely the 
values $\bm{y}$ that are measured in the detector. 
Within the scope of this paper, the unknown model parameter $\theta$
corresponds to the mass $m_{\PHiggs}$ of the $\PHiggs$ boson or,
equivalently, to the true mass $m_{\Pgt\Pgt}$ of the $\Pgt$ lepton
pair in a given event.

The individual terms of Eq.~(\ref{eq:mem}) are described in
Sections~\ref{sec:mem_ME} to~\ref{sec:mem_logM}.
The ME for the process $\Pp\Pp \to \PHiggs \to \Pgt\Pgt$
with subsequent decay of the $\Pgt$ leptons 
via $\Pgt \to \enunu$, $\Pgt \to \mununu$, or $\Pgt \to \textrm{hadrons} + \Pnut$
is described in Section~\ref{sec:mem_ME}.
A complication arises from the fact that we use a leading order (LO)
ME to model the $\PHiggs$ boson production process $\Pp\Pp \to
\PHiggs$. The LO ME strictly applies only to events in which the $\PHiggs$ boson has zero $\pT$,
while the production of $\PHiggs$ bosons at the LHC typically
proceeds in association with jets.
The treatment of events with hadronic activity, in which the $\PHiggs$ boson has non-zero $\pT$,
is detailed in Section~\ref{sec:mem_hadRecoil}.
The TFs are described in Section~\ref{sec:mem_TF} and
the integration over the $n$-particle phase space is described in
Section~\ref{sec:mem_PSintegration}.
The computation of the cross section $\sigma(m_{\PHiggs})$ that is needed for a proper normalization of the probability density $\mathcal{P}(\bm{y}|m_{\PHiggs})$
in Eq.~(\ref{eq:mem}) is described in Section~\ref{sec:mem_xSection}.
The numerical maximization of the probability density $\mathcal{P}(\bm{y}|m_{\PHiggs})$
with respect to the $\PHiggs$ boson mass $m_{\PHiggs}$ is described in
Section~\ref{sec:mem_numericalMaximization}.
We conclude this section with a description of an artificial term that we
choose to add to the probability density $\mathcal{P}(\bm{y}|m_{\PHiggs})$, in
order to reduce tails in the $m_{\Pgt\Pgt}$ distribution reconstructed
by the algorithm. The structure of this ``regularization'' term is described in
Section~\ref{sec:mem_logM}.
Distributions of $m_{\Pgt\Pgt}$ in simulated events,
reconstructed with and without this term, are presented in Section~\ref{sec:results}.

As a consequence of using LO ME to model the $\PHiggs$ boson production process $\Pp\Pp \to \PHiggs$,
the efficiency $\epsilon(\bm{p},m_{\PHiggs})$ and the acceptance $\mathcal{A}(m_{\PHiggs})$ cannot be determined reliably,
because they depend on the $\PHiggs$ boson $\pT$ spectrum.
In particular for $\PHiggs$ bosons of low mass $m_{\PHiggs}$,
the probability for the particles produced in the $\Pgt$ lepton decays to pass selection criteria on $\pT$ and $\eta$, 
which are necessitated by trigger requirements at the LHC,
may vary significantly as function of $\PHiggs$ boson $\pT$.
For this reason, we will assume that $m_{\Pgt\Pgt}$ is reconstructed before any event selection criteria are applied,
\ie $\Omega(\bm{y}) = 1$, $\epsilon(\bm{p},m_{\PHiggs}) = 1$, and $\mathcal{A}(m_{\PHiggs}) = 1$
for all evaluations of Eq.~(\ref{eq:mem}).
We expect these assumptions to introduce a small bias on the reconstructed $m_{\Pgt\Pgt}$ values
and possibly a small degradation in $m_{\Pgt\Pgt}$ resolution.
The bias can be corrected with the Monte Carlo simulation, 
and we do not expect it to cause a problem in practical applications of our algorithm.




