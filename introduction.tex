\section{Introduction}
\label{sec:introduction}

A new boson of mass $125$~\GeV has been observed by the ATLAS and CMS collaborations~\cite{Higgs-Discovery_CMS,Higgs-Discovery_ATLAS}.
The properties of the new particle are compatible with the predictions for the Standard Model (SM) 
Higgs ($\PHiggs$) boson~\cite{Englert:1964et,Higgs:1964ia,Higgs:1964pj,Guralnik:1964eu,Higgs:1966ev,Kibble:1967sv}
within the present experimental uncertainties~\cite{HIG-14-014,Chatrchyan:2014tja,Khachatryan:2014iha,HIG-14-009}.
The observation of its decay into a pair of $\Pgt$ leptons, at a rate that is compatible with the SM expectation, has been reported recently~\cite{HIG-15-002}.
The decay into a pair of $\Pgt$ leptons allows for the most precise measurement of the direct coupling of the SM $\PHiggs$ boson to fermions.
Decays of heavy resonances into $\Pgt$ lepton pairs furthermore provide high sensitivity to search for models with an extended Higgs sector,
constituting an important experimental signature at the LHC.

The sensitivity of the SM $\PHiggs \to \Pgt\Pgt$ analysis critically depends on
the capability to distinguish the signal from a large irreducible background, arising from $\PZ/\Pggx \to \Pgt\Pgt$ Drell--Yan (DY) production.
An important handle to separate the signal from the background is the mass of the $\Pgt$ lepton pair, which we denote by $m_{\Pgt\Pgt}$.
The signal is expected to show up as a small bump on the high mass tail of the $m_{\Pgt\Pgt}$ distribution of the background
(see e.g. Figs. 8, 9, and 11 of Ref.~\cite{HIG-13-004}).

The separation of the signal from the background improves if the mass distribution for the signal is narrow.
The SM predicts the total width of the $\PHiggs$ boson to be $\approx 4$~\MeV.
Present experimental upper limits on the total width amount to $\approx 10$ times the SM value~\cite{HIG-14-002,Aad:2015xua}.
These limits have been obtained by comparing the rates for off-shell versus on-shell $\PHiggs$ boson production and depend on certain assumptions.
Direct, model independent, upper limits on the total $\PHiggs$ width, 
obtained by analyzing the mass spectra in $\PHiggs \to \PZ\PZ \to 4 \Plepton$ ($\Plepton = \Pe, \Pgm$) and $\PHiggs \to \Pgamma\Pgamma$ events, are $\approx 1$~\GeV.
In contrast, the width of the $m_{\Pgt\Pgt}$ distribution reconstructed in SM $\PHiggs \to \Pgt\Pgt$ events typically amounts to $\approx 20$~\GeV 
and is dominated purely by the experimental resolution.

Different methods for the reconstruction of $m_{\Pgt\Pgt}$ 
have been discussed in the literature~\cite{massRecoCollinearApprox,neutrinoRecByVertexInfo,MMC,Barr:2011he,Gripaios:2012th}. 
The SVfit algorithm~\cite{SVfit} has been used to reconstruct the $\PHiggs$ boson mass in the SM $\PHiggs \to \Pgt\Pgt$ analysis
as well as in searches for further $\PHiggs$ bosons predicted by models beyond the SM 
performed by the CMS collaboration during LHC Run $1$~\cite{HIG-10-002,HIG-11-029,HIG-13-004,HIG-13-021,HIG-14-029,HIG-14-033,HIG-14-034,HIG-15-001,HIG-15-013}.
Compared to alternative mass variables,
the usage of the SVfit algorithm has improved the sensitivity of the SM $\PHiggs \to \Pgt\Pgt$ analysis for measuring the signal rate by $\approx 40\%$~\cite{HIG-13-004}.
The improvement in sensitivity corresponds to a gain by about a factor of two in integrated luminosity of the analysed dataset.

In this paper we report on the development of an improved version of the SVfit algorithm.
Two variants of the improved algorithm have been implemented.
The first variant allows to reconstruct the mass $m_{\Pgt\Pgt}$ of the $\Pgt$ lepton pair.
It has been developed within the paradigm of the matrix element (ME) method~\cite{Kondo:1988yd,Kondo:1991dw}.
Whereas the algorithm described in Ref.~\cite{SVfit} uses a likelihood function of arbitrary normalization,
the improved algorithm is based on a proper normalization within the formalism of the ME method.
The second variant of the improved algorithm uses a likelihood function of arbitrary normalization.
The algorithm allows for the reconstruction of not only the mass $m_{\Pgt\Pgt}$ of the $\Pgt$ lepton pair,
but of any kinematic function of the two $\Pgt$ leptons,
including the $\pT$, $\eta$, $\phi$, and transverse mass of the $\Pgt$ lepton pair.
A further improvement concerns the extension of the algorithm to account for the experimental resolution 
on the reconstruction of hadrons that are produced in the $\Pgt$ decays.

The development of the formalism to handle $\Pgt$ decays in the ME method constitutes an important result of this paper,
which has not been discussed in the literature so far.
The formalism described in this paper allows one to extend the ME generated by automatized tools such as CompHEP~\cite{CompHEP1,CompHEP2} or MadGraph~\cite{MadGraph},
which treat $\Pgt$ leptons as stable particles, by the capability to handle $\Pgt$ decays.

The paper is organized as follows. 
In Section~\ref{sec:mem} we describe the first variant of the improved algorithm, 
in particular the formalism that we developed to handle $\Pgt$ decays in the ME method
and our treatment of the experimental resolution on the reconstruction of hadrons that are produced in the $\Pgt$ decays.
The second variant of the algorithm is presented in Section~\ref{sec:classicSVfit}.
The performance of both variants of the improved algorithm in terms of achieved $m_{\Pgt\Pgt}$ resolution 
is compared to the previous version of the SVfit algorithm, used during LHC Run $1$, and to selected alternative mass observables in Section~\ref{sec:performance}.
In Section~\ref{sec:summary} we summarize our results.
